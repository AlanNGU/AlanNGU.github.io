<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Alan&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="alanngu.github.io/"/>
  <updated>2021-01-07T05:56:37.862Z</updated>
  <id>alanngu.github.io/</id>
  
  <author>
    <name>Alan</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>mysql与oracle的区别</title>
    <link href="alanngu.github.io/2029/11/27/orcle%E5%92%8Cmysql%E7%9A%84%E5%8C%BA%E5%88%AB/"/>
    <id>alanngu.github.io/2029/11/27/orcle%E5%92%8Cmysql%E7%9A%84%E5%8C%BA%E5%88%AB/</id>
    <published>2029-11-27T13:47:36.000Z</published>
    <updated>2021-01-07T05:56:37.862Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><h4 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h4><p>Mysql轻巧、免费、开源，适合不是特别大的大型项目<br>Oracle则比较庞大,整个体系也十分健全,适合大型项目或预算充足的项目.</p><h4 id="详述"><a href="#详述" class="headerlink" title="详述"></a>详述</h4><ol><li><p>Oracle是大型数据库, Mysql是中小型数据库</p></li><li><p>Oracle占用内存空间大, Mysql占用空间小</p></li><li><p>Oracle支持大并发访问量,是联机事务处理最好的工具, Mysql并发小,面对大访问量可以使用分表分库优化方式优化</p></li><li><p>Oracle没有自动增长类型, Mysql一般使用自动增长类型</p></li><li><p>Oracle实现了ANSII SQL中事务的隔离级别、传播特性等比Mysql强</p></li><li><p>Mysql的非空字段有空的内容，Oracle里定义了非空字段就不允许有空的内容。</p></li><li><p>Oracle处理分页SQL语句比较繁琐,需要使用到伪列ROWNUM和嵌套查询，Mysql可以使用limit关键字更加优雅的处理分页</p></li><li><p>Mysql安装卸载简单, 而Oracle则是请神容易送神难. 卸载干净很麻烦</p></li><li><p>Mysql事务默认自动提交, 而oracle默认不自动提交,需要用户手动提交事务.</p></li><li><p>在对事务的支持上,Mysql在innodb存储引擎的行级锁的情况下才支持事务,而oracle则完全支持事务.</p></li><li><p>关于保存数据的持久性方面, Mysql在数据更新时进行重启可能造成数据丢失. Oracle把提交的sql操作存到了在线联机日志中,保存到了磁盘上,可以随时恢复</p></li><li><p>MySQL:复制服务器配置简单，但主库出问题时, 丛库有可能丢失一定的数据. 且需要手工切换丛库到主库. Oracle:既有推或拉式的传统数据复制, 也有dataguard的双机或多机容灾机制, 主库出现问题是，可以自动切换备库到主库, 但配置管理较复杂.</p></li></ol><h5 id="隔离级别"><a href="#隔离级别" class="headerlink" title="隔离级别"></a>隔离级别</h5><ul><li><p>Mysql默认隔离级别是repeatable</p></li><li><p>Oracle默认隔离级别是read commited</p></li></ul><h4 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h4><h5 id="为什么mysql使用repeatable而不是read-committed"><a href="#为什么mysql使用repeatable而不是read-committed" class="headerlink" title="为什么mysql使用repeatable而不是read committed?"></a>为什么mysql使用repeatable而不是read committed?</h5><p>在 5.0之前只有statement一种格式, 而主从复制存在了大量的不一致, 故选用repeatable</p><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ul><li><a href="https://www.cnblogs.com/xu-cceed3w/p/8824199.html" target="_blank" rel="noopener">https://www.cnblogs.com/xu-cceed3w/p/8824199.html</a></li></ul><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt;mysql与oracle的区别&lt;/center&gt;
    
    </summary>
    
    
      <category term="MySQL" scheme="alanngu.github.io/categories/MySQL/"/>
    
    
      <category term="MySQL" scheme="alanngu.github.io/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>ORACLE查询操作记录和历史数据</title>
    <link href="alanngu.github.io/2020/11/09/ORACLE%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95%E5%8F%8A%E5%8E%86%E5%8F%B2%E6%95%B0%E6%8D%AE/"/>
    <id>alanngu.github.io/2020/11/09/ORACLE%E6%9F%A5%E8%AF%A2%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95%E5%8F%8A%E5%8E%86%E5%8F%B2%E6%95%B0%E6%8D%AE/</id>
    <published>2020-11-09T13:47:36.000Z</published>
    <updated>2021-01-07T05:56:33.885Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><h4 id="oracle查询数据库操作记录"><a href="#oracle查询数据库操作记录" class="headerlink" title="oracle查询数据库操作记录"></a>oracle查询数据库操作记录</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ORACLE 查询某一时间时数据库的值</span></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> TABLE_NAME <span class="keyword">AS</span> <span class="keyword">OF</span> <span class="built_in">TIMESTAMP</span> TO_TIMESTAMP(<span class="string">'2077-1-7 13:27:17'</span>, <span class="string">'YYYY-MM-DD HH24:MI:SS'</span>)</span><br></pre></td></tr></table></figure><h4 id="查询某个时间下的数据"><a href="#查询某个时间下的数据" class="headerlink" title="查询某个时间下的数据"></a>查询某个时间下的数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- ORACLE 查询数据库操作记录</span></span><br><span class="line"><span class="keyword">SELECT</span> T.SQL_TEXT, T.FIRST_LOAD_TIME <span class="keyword">FROM</span> V$SQLAREA T</span><br><span class="line"><span class="keyword">WHERE</span> T.FIRST_LOAD_TIME <span class="keyword">LIKE</span> <span class="string">'2077-12-23%'</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> T.FIRST_LOAD_TIME <span class="keyword">DESC</span></span><br></pre></td></tr></table></figure><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt;ORACLE查询数据库操作记录和历史数据&lt;/center&gt;
    
    </summary>
    
    
      <category term="ORACLE" scheme="alanngu.github.io/categories/ORACLE/"/>
    
    
      <category term="ORACLE" scheme="alanngu.github.io/tags/ORACLE/"/>
    
  </entry>
  
  <entry>
    <title>review</title>
    <link href="alanngu.github.io/2020/08/25/review/"/>
    <id>alanngu.github.io/2020/08/25/review/</id>
    <published>2020-08-25T00:06:27.000Z</published>
    <updated>2021-01-06T08:54:15.379Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --&gt;&lt;!-- rebuild by neat --&gt;
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>常用MySQL优化</title>
    <link href="alanngu.github.io/2020/05/29/sqloptimize/"/>
    <id>alanngu.github.io/2020/05/29/sqloptimize/</id>
    <published>2020-05-29T09:30:43.000Z</published>
    <updated>2021-01-06T08:54:15.380Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><h3 id="EXPLAIN"><a href="#EXPLAIN" class="headerlink" title="EXPLAIN"></a>EXPLAIN</h3><p>做MySQL优化，我们要善用EXPLAIN查看SQL执行计划。</p><p>下面来个简单的示例，标注（1，2，3，4，5）我们需要重点关注的数据。</p><p><img src="1.png" alt="1"></p><ol><li>type列，连接类型。一个好的sql语句至少要达到range级别。避免出现ALL级别。</li><li>key列，使用到的索引名。如果没有索引将显示NULL</li><li>key_len列，索引长度</li><li>rows列，扫描行数。该值为预估值</li><li>extra列，详细说明。注意:常见的不太友好的值有Using filesort，Using temporary</li></ol><h3 id="SQL语句中IN包含的值不应过多"><a href="#SQL语句中IN包含的值不应过多" class="headerlink" title="SQL语句中IN包含的值不应过多"></a>SQL语句中IN包含的值不应过多</h3><p>MySQL对于IN做了相应的优化，即将IN中的常量全部存到一个排好序数组里面。但是当数值较多时将会产生很大的消耗。</p><p>如<code>select id from table_name where id in(1,2,3)</code>这种连续的值，应当使用between代替。</p><h3 id="SELECT语句务必指定字段名称"><a href="#SELECT语句务必指定字段名称" class="headerlink" title="SELECT语句务必指定字段名称"></a>SELECT语句务必指定字段名称</h3><ul><li>select * 增加了很多不必要的消耗，如cpu、io、内存、网络带宽。</li><li>增加了使用覆盖索引的可能性</li><li>当表结构发生变化时，查询的字段也应当更新。</li></ul><h3 id="只查询一条语句时添加limit-1"><a href="#只查询一条语句时添加limit-1" class="headerlink" title="只查询一条语句时添加limit 1"></a>只查询一条语句时添加limit 1</h3><p>这样可以时EXPLAIN中的type列达到const类型</p><h3 id="排序字段没有用索引，少使用排序"><a href="#排序字段没有用索引，少使用排序" class="headerlink" title="排序字段没有用索引，少使用排序"></a>排序字段没有用索引，少使用排序</h3><h3 id="限制条件中其它字段没有索引，尽量少用or"><a href="#限制条件中其它字段没有索引，尽量少用or" class="headerlink" title="限制条件中其它字段没有索引，尽量少用or"></a>限制条件中其它字段没有索引，尽量少用or</h3><p>or两边的字段中，如果有一个不是索引字段，而其他条件也不是索引字段，会造成不走索引的情况。很多时候使用union all或者是union（必要的时候）的方式来代替or会得到更好的效果。</p><h3 id="尽量用union-all代替union"><a href="#尽量用union-all代替union" class="headerlink" title="尽量用union all代替union"></a>尽量用union all代替union</h3><p>union和union all的差异主要是前者需要将结果集合并后再进行唯一性过滤操作，这回涉及到排序，增加大量的CPU运算，加大资源消耗及延迟。当然，union all的前提条件是两个结果集中没有重复数据。</p><h3 id="不要使用ORDER-By-RAND"><a href="#不要使用ORDER-By-RAND" class="headerlink" title="不要使用ORDER By RAND()"></a>不要使用ORDER By RAND()</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> <span class="string">`table_name`</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">rand</span>() <span class="keyword">limit</span> <span class="number">1000</span>;</span><br></pre></td></tr></table></figure><p>上面的sql语句，可优化为</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> <span class="string">`table_name`</span> t1 <span class="keyword">join</span> (<span class="keyword">select</span> <span class="keyword">rand</span>() * (<span class="keyword">select</span> <span class="keyword">max</span>(<span class="keyword">id</span>) <span class="keyword">from</span> <span class="string">`table_name`</span>) <span class="keyword">as</span> nid) t2 <span class="keyword">on</span> t1.id &gt; t2.nid <span class="keyword">limit</span> <span class="number">1000</span>;</span><br></pre></td></tr></table></figure><h3 id="区分in和exists，not-in和not-exists"><a href="#区分in和exists，not-in和not-exists" class="headerlink" title="区分in和exists，not in和not exists"></a>区分in和exists，not in和not exists</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> table_a <span class="keyword">when</span> <span class="keyword">id</span> <span class="keyword">in</span> (<span class="keyword">select</span> <span class="keyword">id</span> <span class="keyword">from</span> table_b)</span><br></pre></td></tr></table></figure><p>上面sql语句相当于</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> table_a <span class="keyword">when</span> <span class="keyword">exists</span> (<span class="keyword">select</span> * <span class="keyword">from</span> table_b <span class="keyword">where</span> table_b.id = table_a.id)</span><br></pre></td></tr></table></figure><p>区分in和exists主要是造成了驱动顺序的改变，如果是exists，那么以外层表为驱动表，先被访问，如果是in，那么先执行子查询。所以in适合外表大而内表小的情况；exists适合外表小而内标大的情况。</p><p>关于not in和not exists，推荐使用not exists，不仅仅是效率问题，not in可能存在逻辑问题。</p><p>原sql语句</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> colname ... <span class="keyword">from</span> table_a a <span class="keyword">where</span> a.id <span class="keyword">not</span> <span class="keyword">in</span> (selct b.id <span class="keyword">from</span> table_b b)</span><br></pre></td></tr></table></figure><p>高效的语句</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> colname ... <span class="keyword">from</span> table_a a <span class="keyword">left</span> <span class="keyword">join</span> table_b b <span class="keyword">where</span> a.id = b.id <span class="keyword">where</span> b.id <span class="keyword">is</span> <span class="literal">null</span></span><br></pre></td></tr></table></figure><p>即取出a表不在b表中的数据。</p><h3 id="优化分页方式提升效率"><a href="#优化分页方式提升效率" class="headerlink" title="优化分页方式提升效率"></a>优化分页方式提升效率</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,<span class="keyword">name</span> <span class="keyword">from</span> table_name <span class="keyword">limit</span> <span class="number">999888</span>,<span class="number">30</span></span><br></pre></td></tr></table></figure><p>上述sql语句做分页时，随着表数据量的增加，分页的偏移量也越来越大，导致limit分页查询将会越来越慢。</p><p>优化的方式如下：可以取前一页的最大行数的id，然后根据这个最大的id来限制下一页的起点。比如此栗中，上一页最大的id时999888，sql语句可以使用where先把钱999888条数据筛选掉再通过limit取30条数据。</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">selct id,name from table_name where id &gt; 999888 limit 30</span><br></pre></td></tr></table></figure><h3 id="分段查询"><a href="#分段查询" class="headerlink" title="分段查询"></a>分段查询</h3><p>在一些用户选择页面中，可能一些用户选择的时间范围过大，造成查询缓慢。</p><p>主要的原因时扫描行数过多。这个使用可以通过程序，分段进行查询，循环遍历，将结果合并处理进行展示。</p><p>比如查询扫描的行数到达百万级以上的时候就可以使用分段查询</p><h3 id="避免在where子句中对字段进行null值判断"><a href="#避免在where子句中对字段进行null值判断" class="headerlink" title="避免在where子句中对字段进行null值判断"></a>避免在where子句中对字段进行null值判断</h3><p>对于null的判断会导致引擎放弃使用索引而进行全表扫描。</p><h3 id="不建议使用-前缀模糊查询"><a href="#不建议使用-前缀模糊查询" class="headerlink" title="不建议使用%前缀模糊查询"></a>不建议使用%前缀模糊查询</h3><p>例如LIKE ‘%name’ 或 LIKE ‘%name%’, 这种查询会导致索引失效而进行全表扫描。但是使用’name%’不会导致索引失效。</p><p>可以使用全文索引来高效率查询’%name%’.</p><p>创建全文索引的sql语句是：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="string">`table_name`</span> <span class="keyword">ADD</span> FULLTEXT <span class="keyword">INDEX</span> <span class="string">`idx_user_name`</span> (<span class="string">`user_name`</span>);</span><br></pre></td></tr></table></figure><p>使用全文索引的sql语句是：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>,fnum,fdst <span class="keyword">from</span> table_name <span class="keyword">where</span> <span class="keyword">match</span>(user_name) against(<span class="string">'zhangsan'</span> <span class="keyword">in</span> <span class="built_in">boolean</span> <span class="keyword">mode</span>);</span><br></pre></td></tr></table></figure><p>注意：在需要创建全文索引之前，要和项目组长进行确认是否可以创建。同时也要注意查询语句的写法与普通索引的区别。</p><h3 id="参考文档"><a href="#参考文档" class="headerlink" title="参考文档"></a>参考文档</h3><ul><li><a href="https://segmentfault.com/a/1190000012155267" target="_blank" rel="noopener">https://segmentfault.com/a/1190000012155267</a></li></ul><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt;mysql常用的sql语句优化&lt;/center&gt;
    
    </summary>
    
    
      <category term="MySQL" scheme="alanngu.github.io/categories/MySQL/"/>
    
    
      <category term="MySQL" scheme="alanngu.github.io/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MyBatis入门-初识mybatis</title>
    <link href="alanngu.github.io/2020/05/06/mybatis%E5%85%A5%E9%97%A8-%E5%88%9D%E8%AF%86mybatis/"/>
    <id>alanngu.github.io/2020/05/06/mybatis%E5%85%A5%E9%97%A8-%E5%88%9D%E8%AF%86mybatis/</id>
    <published>2020-05-06T11:47:36.000Z</published>
    <updated>2020-05-09T07:49:17.892Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><h3 id="初识MyBatis"><a href="#初识MyBatis" class="headerlink" title="初识MyBatis"></a>初识MyBatis</h3><p>mybatis是一个可以自定义SQL,存储过程和高级映射的持久层框架。之前叫做ibatis。</p><h3 id="MyBatis是什么？"><a href="#MyBatis是什么？" class="headerlink" title="MyBatis是什么？"></a>MyBatis是什么？</h3><p>学习一样技术，我们首先应该了解他能做什么，能解决什么问题。MyBatis是一个持久层的框架。持久层就是MVC模式中的dao层。负责与数据库进行交互。它可以建立数据库表和系统中的对象的一对一映射关系。这种框架我们称之为orm框架。不过MyBatis不像Hibernate那样可以自动生成sql语句，需要我们自己手写SQL语句，并且建立实体类和数据库的映射，所以MyBatis是一个半自动的持久层框架。</p><p>关于映射的含义，我们举个栗子说明一下。在数据库中有一个student表，里面有id，name，age，birthday，gender，class等字段，表中有一条数据，如下图。</p><p><img src="student_database.png" alt="student"></p><p>而系统中也需要有一个与之对应的实体类。</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">Data</span></span><br><span class="line"><span class="keyword">public</span> class Student &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 自增主键</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">Integer</span> id;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 学生名称</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">String</span> name;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 年龄</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">Integer</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 出生日期</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">Data</span> birthday;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 性别</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">Integer</span> gender;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 班级</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="built_in">String</span> classes;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>我们这个表中的数据，对应表中的代码的话，应该是一个Student的对象。这个对象的各个属性的值即为表中的拿一条数据。而框架通过我们的配置，将这个表中记录和这个类的对象建立一对一的关系。我们称之为映射。映射建立之后，我们可以通过操作这个对象实现对数据库的修改。这样在考虑业务逻辑的时候就可以不在考虑我们的数据库中的表是如何存储的，而是对实体对象进行操作，简化开发。</p><p>那么，MyBatis这个框架可以做什么呢？</p><p>其实很简单，无非就是对数据库的增删改查。这是每个持久层框架都应该支持的事情。SQL可以做的事情，mybatis基本上都可以做。</p><p>MyBatis如何使用，下面写一个简单SpringBoot项目演示。</p><p>首先，在pom文件中添加Mybatis相关的坐标</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--mybatis启动器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--druid连接池--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--mysql驱动--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>同时也要为项目添加web支持，坐标如下。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>之后添加springboot启动类</p><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@SpringBootApplication</span></span><br><span class="line"><span class="variable">@MapperScan</span>(<span class="string">"com.alan.dao"</span>)</span><br><span class="line">public class MybatisDemoApplication &#123;</span><br><span class="line">    <span class="selector-tag">public</span> <span class="selector-tag">static</span> <span class="selector-tag">void</span> <span class="selector-tag">main</span>(String[] args) &#123;</span><br><span class="line">        <span class="selector-tag">SpringApplication</span><span class="selector-class">.run</span>(MybatisDemoApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后建立Application.properties文件，添加如下配置。</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">spring<span class="selector-class">.datasource</span>.driver-class-name=com<span class="selector-class">.mysql</span><span class="selector-class">.cj</span><span class="selector-class">.jdbc</span>.Driver</span><br><span class="line">spring<span class="selector-class">.datasource</span>.url=jdbc:mysql:<span class="comment">//192.168.158.129:3306/mybatisdb</span></span><br><span class="line">spring<span class="selector-class">.datasource</span>.username=root</span><br><span class="line">spring<span class="selector-class">.datasource</span>.password=<span class="number">123456</span></span><br><span class="line"></span><br><span class="line">spring<span class="selector-class">.datasource</span>.type=com<span class="selector-class">.alibaba</span><span class="selector-class">.druid</span><span class="selector-class">.pool</span>.DruidDataSource</span><br><span class="line"></span><br><span class="line">mybatis.type-aliases-package=com<span class="selector-class">.alan</span>.entity</span><br><span class="line">mybatis.mapper-locations=classpath:mapper<span class="comment">/*.xml</span></span><br></pre></td></tr></table></figure><p>然后我们在java目录下从创建entity，dao，service，controller包。项目结构如下图；</p><p><img src="project_stucture.png" alt="structure"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = -<span class="number">16937756922340050L</span>;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 自增主键</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 姓名</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 年龄</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">private</span> Object age;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 年龄</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">private</span> Object birthday;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 性别 0:男 1:女</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">private</span> Integer gender;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 班级</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">private</span> String classes;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//省略getter setter方法</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentDao</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过ID查询单条数据</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id 主键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 实例对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Student <span class="title">queryById</span><span class="params">(Integer id)</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过ID查询单条数据</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id 主键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 实例对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function">Student <span class="title">queryById</span><span class="params">(Integer id)</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service</span>(<span class="string">"studentService"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentServiceImpl</span> <span class="keyword">implements</span> <span class="title">StudentService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> StudentDao studentDao;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过ID查询单条数据</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id 主键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 实例对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">queryById</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.studentDao.queryById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"student"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentController</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 服务对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> StudentService studentService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 通过主键查询单条数据</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id 主键</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 单条数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"selectOne"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Student <span class="title">selectOne</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.studentService.queryById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>需要注意要在resource目录下，创建mapper目录，并创建映射xml文件。namespace要对应dao所在的目录，id要与方法名一致。</p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span>?&gt;</span><br><span class="line">&lt;!DOCTYPE mapper PUBLIC <span class="string">"-//mybatis.org//DTD Mapper 3.0//EN"</span> <span class="string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span>&gt;</span><br><span class="line">&lt;mapper namespace=<span class="string">"com.alan.dao.StudentDao"</span>&gt;</span><br><span class="line">    </span><br><span class="line">    &lt;!--查询单个--&gt;</span><br><span class="line">    &lt;select id=<span class="string">"queryById"</span> parameterType=<span class="string">"int"</span> resultType=<span class="string">"student"</span>&gt;</span><br><span class="line">        select</span><br><span class="line">          id, name, age, birthday, gender, classes</span><br><span class="line">        from student</span><br><span class="line">        where id = #&#123;id&#125;</span><br><span class="line">    &lt;/select&gt;</span><br><span class="line">&lt;/mapper&gt;</span><br></pre></td></tr></table></figure><p>最后我们在postman测试seleceOne方法，返回结果如下。</p><p><img src="result.png" alt="result"></p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt;初识mybatis&lt;/center&gt;
    
    </summary>
    
    
      <category term="MyBatis" scheme="alanngu.github.io/categories/MyBatis/"/>
    
    
      <category term="MyBatis" scheme="alanngu.github.io/tags/MyBatis/"/>
    
  </entry>
  
  <entry>
    <title>Spring常用注解</title>
    <link href="alanngu.github.io/2020/04/09/Spring%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3/"/>
    <id>alanngu.github.io/2020/04/09/Spring%E5%B8%B8%E7%94%A8%E6%B3%A8%E8%A7%A3/</id>
    <published>2020-04-09T03:47:36.000Z</published>
    <updated>2020-04-09T07:22:44.909Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><h3 id="Spring部分"><a href="#Spring部分" class="headerlink" title="Spring部分"></a>Spring部分</h3><h4 id="声明bean的注解"><a href="#声明bean的注解" class="headerlink" title="声明bean的注解"></a>声明bean的注解</h4><ul><li><strong>@Component组件</strong> 没有明确的角色</li><li><strong>@Service</strong> 在业务逻辑层使用(service层)</li><li><strong>@Repository</strong> 在数据访问层使用(dao层)</li><li><strong>@Controller</strong> 在控制层使用(Controller层)</li></ul><h4 id="注入bean的注解"><a href="#注入bean的注解" class="headerlink" title="注入bean的注解"></a>注入bean的注解</h4><ul><li><strong>@Autowired</strong> :由<em>spring</em>提供</li><li><strong>@Inject</strong>: 由<em>JSR-330</em>提供</li><li><strong>@Resource</strong> : 由<em>JSR-250</em>提供</li></ul><p>都可以注解在set方法和属性上,推荐注解在属性上,这样更加一目了然,代码更简洁.</p><h4 id="java配置类相关注解"><a href="#java配置类相关注解" class="headerlink" title="java配置类相关注解"></a>java配置类相关注解</h4><ol><li><p><strong>@Configuration</strong> 声明当前类为配置类,相当于xml形式的spring配置(类上)</p></li><li><p><strong>@Bean</strong> 注解在方法上,声明当前方法的返回值为一个bean,替代xml中的方式(方法上)</p></li><li><p><strong>@ComponentScan</strong> 用于对Component进行扫描</p></li><li><p><strong>@WishlyCofiguration</strong> 为<em>@Configuration</em> 与 <em>@ComponentScan</em>的组合注解</p></li></ol><h4 id="AOP相关注解"><a href="#AOP相关注解" class="headerlink" title="AOP相关注解"></a>AOP相关注解</h4><p>Spring支持AspeccJ的注解式切面编程.</p><p><strong>@Aspect</strong> 声明一个切面(类上)</p><p>使用@After @Before @Around定义建言(advice), 可直接将拦截规则(切点)作为参数</p><ul><li>@After 在方法执行之后执行</li><li>@Before 在方法执行之前执行</li><li>@Around 在方法执行之前和之后执行</li></ul><p>@PointCut声明切点</p><p>在java配置类中使用@EnableAspectJAutoProxy注解开启Spring对AspectJ代理的支持.(类上)</p><h4 id="Bean的属性支持"><a href="#Bean的属性支持" class="headerlink" title="@Bean的属性支持"></a>@Bean的属性支持</h4><p>@Scope设置Spring容器如何新建Bean实例(方法上,需要有@Bean)</p><p>其设置包括:</p><ul><li>Singleton (单例,一个Spring容器中只有一个bean实例,默认模式)</li><li>Protetype (每次调用新建一个bean)</li><li>request (web项目中,给每个http request新建一个bean)</li><li>Session (web项目中,给每个http session新建一个bean)</li><li>GlobalSession (给每一个Global http session新建一个Bean实例)</li></ul><p>@StepScope 在Spring Batch中还有涉及</p><p>@PostConstruct 由JSR-250提供,在构造函数执行完之后执行,等价于xml配置文件中bean的initMethod.</p><p>@PreDestory 由JSR-250提供,在Bean销毁之前执行,等价于xml配置文件中bean的destroyMethod.</p><h4 id="Value注解"><a href="#Value注解" class="headerlink" title="@Value注解"></a>@Value注解</h4><p>@Value 为属性注入值(属性上)</p><p>支持如下方式的注入</p><p>注入普通字符</p><pre><code>@value(&quot;Alan Walker&quot;)String name;</code></pre><p>注入操作系统属性</p><pre><code>@Value(&quot;#{systemProperties[&apos;os.name]}&quot;)String osName;</code></pre><p>注入表达式结果</p><pre><code>@Value(&quot;#{T(java.lang.Math).random() * 100}&quot;)String randomNumber;</code></pre><p>注入其他bean属性</p><pre><code>@Value(&quot;#{domeClass.name}&quot;)String name;</code></pre><p>注入文件资源</p><pre><code>@Value(&quot;classpath:com/hello/demo.txt&quot;)String Resource file;</code></pre><p>注入配置文件</p><pre><code>@Value(&quot;@{student.name}&quot;)String studentName;</code></pre><p>注入配置的使用方法:</p><ol><li>编写配置文件(test.properties)</li></ol><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">student.name</span> = <span class="string">"张三"</span></span><br></pre></td></tr></table></figure><ol start="2"><li>@PropertySource加载配置文件(类上)</li></ol><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PropertySource(<span class="meta-string">"classpath:com/hello/test/test.properties"</span>)</span></span><br></pre></td></tr></table></figure><ol start="3"><li>还需要配置一个PropertySourcePlaceholderConfigurer的bean.</li></ol><h4 id="环境切换"><a href="#环境切换" class="headerlink" title="环境切换"></a>环境切换</h4><p><strong>@Profile</strong>通过设定Environment的ActiveProfiles来设定当前context需要使用的配置环境.(类或方法上)</p><p><strong>@Conditional</strong> Spring4中可以使用词注解定义条件化的bean,通过实现Condition接口,并重写matches方法,从而决定该bean是否被实例化.(方法上)</p><h4 id="异步相关"><a href="#异步相关" class="headerlink" title="异步相关"></a>异步相关</h4><p>@EnableAsync 配置类中,通过从注解开启对异步任务的支持.</p><p>@Async 在实际执行的bean方法使用该注解来申明其是一个异步任务(方法上或类上所有的方法都将异步,需要@EnableAsync开启异步任务)</p><h4 id="定时任务相关"><a href="#定时任务相关" class="headerlink" title="定时任务相关"></a>定时任务相关</h4><p>@EnableScheduling 在配置类上使用,开启计划任务的支持(类上)</p><p>@Scheduled 来申明这是一个任务,包括cron.fixDelay.fixRate等类型(方法上,需开启计划任务的支持)</p><h4 id="Enable-注解说明"><a href="#Enable-注解说明" class="headerlink" title="@Enable*注解说明"></a>@Enable*注解说明</h4><ul><li>@EnableAspectJAutoproxy 开启对AspectJ自动代理的支持</li><li>@EnableAsync 开启异步方法的支持</li><li>@EnableScheduling 开启计划任务的支持</li><li>@EnableWebMvc 开启Web MVC的配置支持</li><li>@EnableConfigurationProperties 开启对@ConfigurationProperties注解配置Bean的支持</li><li>@EnableJpaRepositories 开启对SpringData JPA Repository的支持</li><li>@EnableTransactionManagement 开启注解式事务的支持</li><li>@EnableCaching 开启注解式的缓存支持</li></ul><h4 id="测试相关注解"><a href="#测试相关注解" class="headerlink" title="测试相关注解"></a>测试相关注解</h4><p>@RunWith运行器,Spring中通常用于对JUnit的支持</p><pre><code>@RunWith(SpringJUnit4ClassRunner.class)</code></pre><p>@ContextConfiguration 用来加载配置ApplicationContext,其中classes属性用来加载配置类</p><pre><code>@ContextConfiguration(classes={TestConfig.class})</code></pre><h3 id="SpringMVC-部分"><a href="#SpringMVC-部分" class="headerlink" title="SpringMVC 部分"></a>SpringMVC 部分</h3><p><strong>@EnableWebMvc</strong></p><p>在配置类中开启Web MVC的配置支持</p><p><strong>@Controller</strong></p><p>声明该类为SpringMVC中的Controller</p><p><strong>@ResponseBody</strong></p><p>支持将返回值放到Response内,而不是一个页面,通常用户返回json数据(返回值旁或方法上)</p><p><strong>@RequestBody</strong></p><p>允许request的参数在request体中,而不是在直接连接在地址后面.(放在参数前)</p><p><strong>@PathVariable</strong></p><p>用于接收路径参数,如@RequestMapping(“hello/{name}”)申明的路径,将注解放在参数前,即可获取该值,通常作为Restful的接口实现方法.</p><p><strong>@RestController</strong></p><p>该注解为一个组合注解,相当与@Controller和ResponseBody的组合,注解在类上,意味着该Controller的所有方法都默认加上了@ResponseBody.</p><p><strong>@ControllerAdvice</strong></p><p>通过该注解,我们可以对于控制器的全局配置放置在同一个位置,注解了@Controller的类的方法可以使用@ExceptionHandler @InitBinder @ModelAttribute注解到方法上,这对所有注解了@RequestMapping的控制器内的方法有效.</p><p><strong>@ExceptionHandler</strong></p><p>用于全局处理控制器里的异常.</p><p><strong>@ModelAttribute</strong></p><p>注解到方法上,将数据添加到模型对象中，用于视图页面展示时使用@ModelAttribute等价于 model.addAttribute(“attributeName”, abc);</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt;java开发中常用注解&lt;/center&gt;
    
    </summary>
    
    
      <category term="Spring" scheme="alanngu.github.io/categories/Spring/"/>
    
    
      <category term="Spring" scheme="alanngu.github.io/tags/Spring/"/>
    
  </entry>
  
  <entry>
    <title>Docker(1)</title>
    <link href="alanngu.github.io/2020/02/16/Docker/"/>
    <id>alanngu.github.io/2020/02/16/Docker/</id>
    <published>2020-02-16T12:36:32.000Z</published>
    <updated>2020-04-09T03:19:01.039Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><h3 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h3><h4 id="Docker是什么"><a href="#Docker是什么" class="headerlink" title="Docker是什么"></a>Docker是什么</h4><p>Docker最初是dotCloud公司创始人Solomon Hykes在法国期间发起的一个公司内部项目，在2013年3月以Apache 2.0授权协议开源, 主要项目代码在GitHub上进行维护.</p><p>Docker使用Google公司推出的Go语言进行开发实现.</p><p>Docker是Linux容器的一种封装,提供简单易用的容器使用接口.它是最流行的linux容器解决方案.</p><p>Docker的接口相当简单,用户可以方便的创建和销毁容器.</p><p>Docker将应用程序与程序的依赖,打包在一个文件里面.运行这个文件就会生成一个虚拟容器.</p><p>程序运行在虚拟容器里,如同在真实物理机上运行一样.不需要在担心开发环境和测试环境不一致的问题.</p><h4 id="应用环境"><a href="#应用环境" class="headerlink" title="应用环境"></a>应用环境</h4><ul><li>web应用的自动化打包和发布</li><li>自动化测试和持续集成、发布</li><li>在服务型环境中部署和调整数据库或其他应用</li></ul><h4 id="Docker的三大概念及优势"><a href="#Docker的三大概念及优势" class="headerlink" title="Docker的三大概念及优势"></a>Docker的三大概念及优势</h4><ul><li><strong>镜像</strong> image</li><li><strong>容器</strong> container</li><li><strong>仓库</strong> repository</li></ul><blockquote><p>Docker容纳容器的优势</p><blockquote><p>1 更为高效的利用系统资源<br>2 更快速的启动时间<br>3 一致的运行环境<br>4 持续交付和部署<br>5 更轻松的迁移</p></blockquote></blockquote><h3 id="Docker安装"><a href="#Docker安装" class="headerlink" title="Docker安装"></a>Docker安装</h3><p>系统环境:docker最低支持centos7且在64位平台上,内核版本在3.10以上<br>版本: 社区版, 企业版(包含了一些收费服务)<br><a href="https://docs.docker.com/engine/install/centos/" target="_blank" rel="noopener">官方安装教程</a></p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt;doker基本知识&lt;/center&gt;
    
    </summary>
    
    
      <category term="Docker" scheme="alanngu.github.io/categories/Docker/"/>
    
    
      <category term="Docker" scheme="alanngu.github.io/tags/Docker/"/>
    
  </entry>
  
  <entry>
    <title>git项目部署</title>
    <link href="alanngu.github.io/2020/01/15/deployProject/"/>
    <id>alanngu.github.io/2020/01/15/deployProject/</id>
    <published>2020-01-15T08:47:39.000Z</published>
    <updated>2020-01-17T07:16:21.338Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><ul><li><p>点击 + 按钮选择新建仓库<br><img src="createRepository.png" alt=""><br><img src="createRepository2.png" alt=""><br><img src="createRepository3.png" alt=""></p></li><li><p>初始化本地仓库</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">git init</span></span><br></pre></td></tr></table></figure></li><li><p>关联本地仓库与远程仓库</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git remote <span class="built_in">add</span> origin http<span class="variable">s:</span>//gitee.<span class="keyword">com</span>/xxx/testRepository.git</span><br></pre></td></tr></table></figure></li><li><p>在push之前先pull</p><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull origin <span class="keyword">master</span> <span class="title">--allow-unrelated-histories</span></span><br></pre></td></tr></table></figure></li><li><p>将本地仓库push到远程仓库</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">add</span><span class="bash"> .</span></span><br><span class="line">git commit -m <span class="string">'first commit'</span></span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure></li></ul><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt;部署本地仓库到码云远程仓库&lt;/center&gt;
    
    </summary>
    
    
      <category term="git" scheme="alanngu.github.io/categories/git/"/>
    
      <category term="deploy" scheme="alanngu.github.io/categories/git/deploy/"/>
    
    
      <category term="git" scheme="alanngu.github.io/tags/git/"/>
    
      <category term="deploy" scheme="alanngu.github.io/tags/deploy/"/>
    
  </entry>
  
  <entry>
    <title>Maven</title>
    <link href="alanngu.github.io/2019/11/09/maven/"/>
    <id>alanngu.github.io/2019/11/09/maven/</id>
    <published>2019-11-09T13:25:12.000Z</published>
    <updated>2020-04-09T08:41:47.339Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><h3 id="Maven是什么？"><a href="#Maven是什么？" class="headerlink" title="Maven是什么？"></a>Maven是什么？</h3><p>Maven是Apache下的一个纯java开发的一个开源项目，他是一个能够抽象构建过程，并且提供依赖管理，中央仓库，自动下载构建等功能的项目构建工具。</p><h3 id="为什么选择Maven工具构建项目？"><a href="#为什么选择Maven工具构建项目？" class="headerlink" title="为什么选择Maven工具构建项目？"></a>为什么选择Maven工具构建项目？</h3><p>可以解决项目中所有的jar包都需要统一导入和维护，后期维护难度极高的问题</p><p>假如我们在开发两个java项目，暂时称为A&amp;B，这两个项目中对于一些特殊功能会有一些特殊功能会有相互依赖的情况下，该如何做两者之间较好的关联呢？<br>A: 将公共的代码打包成jar引入项目中使用<br>缺点：后期进行代码更新需要对所有引入的jar包进行更新,繁琐.</p><h3 id="Maven如何进行jar的管理？"><a href="#Maven如何进行jar的管理？" class="headerlink" title="Maven如何进行jar的管理？"></a>Maven如何进行jar的管理？</h3><p>在maven这款工具里面，有一个概念称为坐标。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.47<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p>例如上面的坐标信息<br>Group代表 该jar所属的实际项目，由于通常一个项目可能会划分为多个模块，因此artifactId则是对于该项目的某个模块进行了一个明确的标识。<br>Version元素更多的是定义了该构件的真实版本。通常我们会称呼这一段dependency为依赖</p><p>对于依赖的读取还有一个Scope的配置</p><blockquote><p>scope</p><blockquote><p>a. compile 默认，意味着该依赖纪要参与编译又要参与后期测试<br>b. test 标识该依赖仅仅参加测试有关的工作<br>c. provided 可以参与编译、测试、运行等周期，但是打包时会进行exclude的相应操作。其他方面和compile差异不大<br>d. runntime 在编译环节不会参与进来，个人感觉和compile差异不大<br>e. system 通常是指不从仓库中读取依赖，而是通过本地路径来读取依赖，通常与systemPath标签结合使用。</p></blockquote></blockquote><p>基于parent的依赖管理</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure><p>基于properties的依赖管理，在properties里面我们可以进行整个项目的统一字符集编码管理或者对于一些依赖jar包统一版本号的管理</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">lombok.version</span>&gt;</span>1.16.6<span class="tag">&lt;/<span class="name">lombok.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mybatis.version</span>&gt;</span>3.3.0<span class="tag">&lt;/<span class="name">mybatis.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="Maven的仓库"><a href="#Maven的仓库" class="headerlink" title="Maven的仓库"></a>Maven的仓库</h3><p>当我们导入相应的依赖时，maven调用内部从网络上下载依赖的功能，我们成这个拥有依赖的平台为仓库。</p><blockquote><p>仓库</p><blockquote><p>a. 本地仓库 从网上下载下来的jar会存储在本地仓库<br>b. 第三方仓库 公司或内部搭建的公共仓库站点<br>c. 中央仓库 maven官方自己维护的一个远程公用仓库</p></blockquote></blockquote><p>可以通过尝试将mirror配置修改成访问阿里云镜像的配置</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>alimaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">name</span>&gt;</span>aliun maven<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">url</span>&gt;</span>http://maven.aliyun.com/nexus/content/goups/public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>central<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>nexus</strong>是一款较为强大的maven仓库管理工具，它极大的简化 了自己内部仓库的维护和外部仓库的访问。Nexus是一套开箱即用的系统，不需要配置数据库，它使用文件管理系统夹Lucene来组成数据。Nexus使用ExtJS来开发界面，利用Restlet来提供完整的REST APIs，通过m2eclipse与eclipse集成使用。Nexus支持WebDAV与LDAP安全身份认证。<br>除了Nexus以外，还有Jfrog Artifactory仓库管理工具</p><h3 id="Maven工程的项目结构是如何的呢？"><a href="#Maven工程的项目结构是如何的呢？" class="headerlink" title="Maven工程的项目结构是如何的呢？"></a>Maven工程的项目结构是如何的呢？</h3><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">src</span><br><span class="line">    <span class="selector-tag">a</span>. main</span><br><span class="line">        <span class="selector-tag">i</span>. java</span><br><span class="line">        ii. resources</span><br><span class="line">    <span class="selector-tag">b</span>. test</span><br><span class="line">        <span class="selector-tag">i</span>. java</span><br><span class="line">        ii. resources</span><br></pre></td></tr></table></figure><p>通常的业务代码放在java下，测试在test目录下，resources放置yml，xml，properties等配置文件项目结构可能会因为idea的版本不同而有差异</p><h3 id="Maven的常用命令和生命周期？"><a href="#Maven的常用命令和生命周期？" class="headerlink" title="Maven的常用命令和生命周期？"></a>Maven的常用命令和生命周期？</h3><p>Maven本身有三套独立的生命周期和各自的职能，如下<br>|clean | default | site|<br>|—|—|—|<br>|清理 | 构建 | 建立站点|</p><p>Clean<br>pre-clean –&gt; clean –&gt; post-clean</p><p>常用命令</p><ol><li>mvn archetype:create –&gt; 创建Maven项目</li><li>mvn compile –&gt; 编译源代码</li><li>mvn test-compile –&gt; 编译测试代码</li><li>mvn test –&gt; 运行应用程序中的单元测试</li><li>mvn site –&gt; 生成项目相关信息的网点</li><li>mvn clean –&gt; 清除目标目录中的生成结果</li><li>mvn package –&gt; 依据项目生成jar文件</li><li>mvn install –&gt; 在本地Repository中安装jar</li></ol><p><strong>通过profile文件来指定特定的编译环境</strong></p><p>在实际的项目开发过程中，我们通常会需要结合实际的应用场景切换不同的运行环境<br>dev、test、pre、pro，在不同的环境中读取不同的配置文件</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">profiles</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 本地环境配置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>dev<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">profiles.active</span>&gt;</span>dev<span class="tag">&lt;/<span class="name">profiles.active</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">activation</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">activeByDefault</span>&gt;</span>true<span class="tag">&lt;/<span class="name">activeByDefault</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 测试环境配置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>test<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">profiles.active</span>&gt;</span>test<span class="tag">&lt;/<span class="name">profiles.active</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 生产环境 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">id</span>&gt;</span>pro<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">profiles.active</span>&gt;</span>pro<span class="tag">&lt;/<span class="name">profiles.active</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profile</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">profiles</span>&gt;</span></span><br></pre></td></tr></table></figure><p>在pom文件里面配置以上相应的profile内容之后,在进入工程打包的时候默认通过mvn<br>clean package-Pdev(对应profile文件的id)的方式来判断不同环境下的读取方式</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt;Maven基础&lt;/center&gt;
    
    </summary>
    
    
      <category term="Maven" scheme="alanngu.github.io/categories/Maven/"/>
    
    
      <category term="Maven" scheme="alanngu.github.io/tags/Maven/"/>
    
  </entry>
  
  <entry>
    <title>Lombok Document</title>
    <link href="alanngu.github.io/2019/06/16/LombokDocument/"/>
    <id>alanngu.github.io/2019/06/16/LombokDocument/</id>
    <published>2019-06-16T02:08:17.000Z</published>
    <updated>2020-01-17T07:16:21.338Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><ul><li>lombok可以减少程序中冗长简单的代码，自动生成Getter、Setter、构造函数和hashCode等函数。</li></ul><h3 id="Use-Lombok-In-Intellij-IDEA"><a href="#Use-Lombok-In-Intellij-IDEA" class="headerlink" title="Use Lombok In Intellij IDEA"></a>Use Lombok In Intellij IDEA</h3><h4 id="Install-lombok-Plugin"><a href="#Install-lombok-Plugin" class="headerlink" title="Install lombok Plugin"></a>Install lombok Plugin</h4><p>通过Intellij的插件中心安装 settings &gt;&gt; Plugins</p><h4 id="Add-Dependency"><a href="#Add-Dependency" class="headerlink" title="Add Dependency"></a>Add Dependency</h4><p>在使用Lombok注解时需要在pom中添加依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.16.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="Lombok-features"><a href="#Lombok-features" class="headerlink" title="Lombok features"></a>Lombok features</h3><h4 id="val"><a href="#val" class="headerlink" title="val"></a>val</h4><p>你可以使用<code>val</code>来声明<strong>局部变量</strong>,不用声明变量的具体类型,编译器会根据初始化表达式中推断出当前局部变量的类型,同时此变量声明为<code>final</code>.初始化表达式是必需的,此功能仅适用于<strong>局部变量</strong>和<strong>foreach循环</strong>，不适用于<u>字段</u>。</p><h4 id="NonNull"><a href="#NonNull" class="headerlink" title="@NonNull"></a>@NonNull</h4><p>可以将<code>@NonNull</code>用在方法或者构造函数的参数上,<u>Lombok</u>将自动生成非空判断. 如果你使用<u>Lombok</u>生成了整个方法或者构造函数(比如<code>@Data</code>),<u>Lombok</u>会默认使用<code>@NonNull</code>修饰字段形成非空判断. 但是,如果你显式使用@NonNull修饰了自己的方法或构造函数上的参数,那么它将只在你修饰的参数上生成非空判断.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.NonNull;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NonNullExample</span> <span class="keyword">extends</span> <span class="title">Something</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">NonNullExample</span><span class="params">(@NonNull Person person)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(<span class="string">"Hello"</span>);</span><br><span class="line">    <span class="keyword">this</span>.name = person.getName();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>$\Downarrow$$\Downarrow$相当于如下代码$\Downarrow$$\Downarrow$</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.NonNull;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NonNullExample</span> <span class="keyword">extends</span> <span class="title">Something</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">NonNullExample</span><span class="params">(@NonNull Person person)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">super</span>(<span class="string">"Hello"</span>);</span><br><span class="line">    <span class="keyword">if</span> (person == <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException(<span class="string">"person is marked @NonNull but is null"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.name = person.getName();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Cleanup"><a href="#Cleanup" class="headerlink" title="@Cleanup"></a>@Cleanup</h4><p>自动管理资源，用在局部变量之前，在当前变量范围内即将执行完毕退出之前会自动清理资源，自动生成try-finally这样的代码流</p><h4 id="Getter-Setter"><a href="#Getter-Setter" class="headerlink" title="@Getter @Setter"></a>@Getter @Setter</h4><p>用在属性上，不需要自己手写Setter和getter方法了，还可以指定访问范围<br>将@Getter和@Setter注解在类上将会自动生成所有字段的getter和setter方法,如果不需要生成所有,可以在需要生成getter和setter的字段前修饰.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.Getter;</span><br><span class="line"><span class="keyword">import</span> lombok.Setter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Getter</span> <span class="meta">@Setter</span> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String age;</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>$\Downarrow$$\Downarrow$相当于如下代码$\Downarrow$$\Downarrow$</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String age;</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(String age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getGender</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> gender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setGender</span><span class="params">(String gender)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.gender = gender;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ToString"><a href="#ToString" class="headerlink" title="@ToString"></a>@ToString</h4><p>用在类上，可以自动复写<code>toString</code>方法，它将默认打印你的类名和所有字段并用逗号分隔.还可以添加其他的参数，例如@ToString( exclude = “id” )排除id属性，或者使用<code>ToString.Inclued</code>和 <code>ToString.Exclude</code>来控制打印或不打印指定字段.<br>@ToString(callSuper=true,includeFieldNames=true)调用父类的toString方法，包含所有属性</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.ToString;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ToStringExample</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> STATIC_VAR = <span class="number">10</span>;</span><br><span class="line">  <span class="keyword">private</span> String name;</span><br><span class="line">  <span class="keyword">private</span> Shape shape = <span class="keyword">new</span> Square(<span class="number">5</span>, <span class="number">10</span>);</span><br><span class="line">  <span class="keyword">private</span> String[] tags;</span><br><span class="line">  <span class="meta">@ToString</span>.Exclude <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="meta">@ToString</span>(callSuper=<span class="keyword">true</span>, includeFieldNames=<span class="keyword">true</span>)</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Square</span> <span class="keyword">extends</span> <span class="title">Shape</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> width, height;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Square</span><span class="params">(<span class="keyword">int</span> width, <span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.width = width;</span><br><span class="line">      <span class="keyword">this</span>.height = height;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="EqualsAndHashCode"><a href="#EqualsAndHashCode" class="headerlink" title="@EqualsAndHashCode"></a>@EqualsAndHashCode</h4><p>用在类上，自动生成<code>equals</code>方法和<code>hashCode</code>方法</p><h4 id="NoArasConstructor"><a href="#NoArasConstructor" class="headerlink" title="@NoArasConstructor"></a>@NoArasConstructor</h4><p>自动生成<code>无参构造函数</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@NoArgsConstructor</span> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String age;</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>$\Downarrow$$\Downarrow$相当于如下代码$\Downarrow$$\Downarrow$</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String age;</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line">    <span class="comment">// 构造方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="AllAragsConstructor"><a href="#AllAragsConstructor" class="headerlink" title="@AllAragsConstructor"></a>@AllAragsConstructor</h4><p>生成全参构造方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String age;</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>$\Downarrow$$\Downarrow$相当于如下代码$\Downarrow$$\Downarrow$</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String age;</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(String name, String age, String gender)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.gender = gender;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="RequiredArgsConstructor"><a href="#RequiredArgsConstructor" class="headerlink" title="@RequiredArgsConstructor"></a>@RequiredArgsConstructor</h4><p><code>@RequiredArgsConstructor</code>生成一个包含标识了<strong>NonNull</strong>的变量的构造方法</p><h4 id="Data"><a href="#Data" class="headerlink" title="@Data"></a>@Data</h4><p>注解在类上，相当于同时使用了@ToString，@EqualsAndHashCode，@Getter，@Setter和@RequiredArgsConstructor这些注解</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span> <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String firstname;</span><br><span class="line">    <span class="keyword">private</span> String lastname;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>$\Downarrow$$\Downarrow$相当于如下代码$\Downarrow$$\Downarrow$</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String firstname;</span><br><span class="line">    <span class="keyword">private</span> String lastname;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getFirstname</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> firstname;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getLastname</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> lastname;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setFirstname</span><span class="params">(String firstname)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.firstname = firstname;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLastname</span><span class="params">(String lastname)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.lastname = lastname;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> hash = <span class="number">7</span>;</span><br><span class="line">        hash = <span class="number">17</span> * hash + Objects.hashCode(<span class="keyword">this</span>.firstname);</span><br><span class="line">        hash = <span class="number">17</span> * hash + Objects.hashCode(<span class="keyword">this</span>.lastname);</span><br><span class="line">        <span class="keyword">return</span> hash;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object obj)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span> == obj) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (obj == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (getClass() != obj.getClass()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">final</span> Person other = (Person) obj;</span><br><span class="line">        <span class="keyword">if</span> (!Objects.equals(<span class="keyword">this</span>.firstname, other.firstname)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (!Objects.equals(<span class="keyword">this</span>.lastname, other.lastname)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">boolean</span> <span class="title">canEqual</span><span class="params">(<span class="keyword">final</span> Object other)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> other <span class="keyword">instanceof</span> Person;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"Person&#123;"</span> + <span class="string">"firstname="</span> + firstname + <span class="string">", lastname="</span> + lastname + <span class="string">'&#125;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Value"><a href="#Value" class="headerlink" title="@Value"></a>@Value</h4><p>用在类上，是@Data的不可变形式，相当于属性为final声明，只提供getter方法，而不是提供setter方法</p><h4 id="Builder"><a href="#Builder" class="headerlink" title="@Builder"></a>@Builder</h4><p>可以让类的实例化通过一条语句链式生成,比如$\Downarrow$</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Person.builder().name(<span class="string">"Adam Savage"</span>).city(<span class="string">"San Francisco"</span>)</span><br></pre></td></tr></table></figure><h3 id="Reference-Documents"><a href="#Reference-Documents" class="headerlink" title="Reference Documents"></a>Reference Documents</h3><ul><li><a href="https://projectlombok.org/features/all" target="_blank" rel="noopener">https://projectlombok.org/features/all</a></li><li><a href="https://stevenmwesigwa.com" target="_blank" rel="noopener">https://stevenmwesigwa.com</a></li></ul><h3 id="Download"><a href="#Download" class="headerlink" title="Download"></a>Download</h3><p><a href="https://projectlombok.org/download" target="_blank" rel="noopener" class="LinkCard">Lombok官方下载</a></p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt;Lombok Basic Usage&lt;/center&gt;
    
    </summary>
    
    
      <category term="Lombok" scheme="alanngu.github.io/categories/Lombok/"/>
    
    
      <category term="Lombok" scheme="alanngu.github.io/tags/Lombok/"/>
    
  </entry>
  
  <entry>
    <title>Java常用类之BigDecimal</title>
    <link href="alanngu.github.io/2019/06/06/BigDecimal/"/>
    <id>alanngu.github.io/2019/06/06/BigDecimal/</id>
    <published>2019-06-06T12:06:34.000Z</published>
    <updated>2020-05-29T02:28:34.272Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>为了能精确表示、计算浮点数，Java提供了BigDecimal类，该类提供了大量的构造器用于创建BigDecimal对象，包括把所有的基本数值型变量转换成一个BigDecimal对象，也包括利用数字字符串、数字字符数组来创建BigDecimal对象。</p><p>在数据库进行设计时要求表示金额的字段一律使用BigDecimal。</p><p>使用float或double两种浮点类型的话会因为精度丢失问题使金额在计算时可能出现不可意料的情况。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DoubleTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"0.05 + 0.01 ="</span> + (<span class="number">0.05</span> + <span class="number">0.01</span>));</span><br><span class="line">        System.out.println(<span class="string">"1.0 - 0.42 ="</span>+ (<span class="number">1.0</span> - <span class="number">0.42</span>));</span><br><span class="line">        System.out.println(<span class="string">"4.015 * 100 ="</span> + (<span class="number">4.015</span> * <span class="number">100</span>));</span><br><span class="line">        System.out.println(<span class="string">"123.3 / 100 ="</span>+(<span class="number">123.3</span> / <span class="number">100</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果如下：</p><blockquote><p>0.05 + 0.01 =0.060000000000000005<br>1.0 - 0.42 =0.5800000000000001<br>4.015 * 100 =401.49999999999994<br>123.3 / 100 =1.2329999999999999</p></blockquote><p>从上面程序运行结果表明，Java的double类型会发生精度丢失，尤其在进行算术运算时更容易发生这种情况。不仅是Java，很多编程语言也存在这种问题。</p><h3 id="Instance"><a href="#Instance" class="headerlink" title="Instance"></a>Instance</h3><p>必须使用double浮点数作为BigDecimal构造器的参数时，应避免直接将double浮点数作为构造器参数，二十通过BigDecimal.valueOf(double value)静态方法来创建BigDecimal对象。</p><p>如果程序中要求对double浮点数进行加减乘除基本运算，则需要先将double类型数值包装成BigDecimal对象，调用BigDecimal对象的方法执行运算后在将结果转换成double类型变量。比较繁琐，可以考虑以BigDecimal为基础定义一个Arith工具类。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Arith</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 默认除法运算精度</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> DEF_DIV_SCALE = <span class="number">10</span>;</span><br><span class="line">    <span class="comment">// 构造器私有,使这个类不可实例化</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Arith</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 提供精确的加法运算</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> v1 被加数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> v2 加数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 两个参数的和</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">add</span><span class="params">(<span class="keyword">double</span> v1, <span class="keyword">double</span> v2)</span> </span>&#123;</span><br><span class="line">        BigDecimal b1 = BigDecimal.valueOf(v1);</span><br><span class="line">        BigDecimal b2 = BigDecimal.valueOf(v2);</span><br><span class="line">        <span class="keyword">return</span> b1.add(b2).doubleValue();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 提供精确的减法运算</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> v1 被减数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> v2 减数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 两个参数的差</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">sub</span><span class="params">(<span class="keyword">double</span> v1, <span class="keyword">double</span> v2)</span> </span>&#123;</span><br><span class="line">        BigDecimal b1 = BigDecimal.valueOf(v1);</span><br><span class="line">        BigDecimal b2 = BigDecimal.valueOf(v2);</span><br><span class="line">        <span class="keyword">return</span> b1.subtract(b2).doubleValue();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 提供精确的乘法运算</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> v1 被乘数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> v2 乘数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 两个参数的积</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">mul</span><span class="params">(<span class="keyword">double</span> v1, <span class="keyword">double</span> v2)</span> </span>&#123;</span><br><span class="line">        BigDecimal b1 = BigDecimal.valueOf(v1);</span><br><span class="line">        BigDecimal b2 = BigDecimal.valueOf(v2);</span><br><span class="line">        <span class="keyword">return</span> b1.multiply(b2).doubleValue();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 提供精确的除法运算</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> v1 被除数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> v2 除数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 两个参数的商</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">double</span> <span class="title">div</span><span class="params">(<span class="keyword">double</span> v1, <span class="keyword">double</span> v2)</span> </span>&#123;</span><br><span class="line">        BigDecimal b1 = BigDecimal.valueOf(v1);</span><br><span class="line">        BigDecimal b2 = BigDecimal.valueOf(v2);</span><br><span class="line">        <span class="keyword">return</span> b1.divide(b2, DEF_DIV_SCALE, </span><br><span class="line">                BigDecimal.ROUND_HALF_UP).doubleValue();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"0.05 + 0.01 = "</span> + Arith.add(<span class="number">0.05</span>, <span class="number">0.01</span>));</span><br><span class="line">        System.out.println(<span class="string">"1.0 - 0.42 = "</span>+ Arith.sub(<span class="number">1.0</span>, <span class="number">0.42</span>));</span><br><span class="line">        System.out.println(<span class="string">"4.015 * 100 = "</span> + Arith.mul(<span class="number">4.015</span>, <span class="number">100</span>));</span><br><span class="line">        System.out.println(<span class="string">"123.3 / 100 = "</span>+ Arith.div(<span class="number">123.3</span>, <span class="number">100</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面main方法的结果如下：</p><blockquote><p>0.05 + 0.01 = 0.06<br>1.0 - 0.42 = 0.58<br>4.015 * 100 = 401.5<br>123.3 / 100 = 1.233</p></blockquote><p>如上运行结果正是我们所期望的，这就是使用BigDecimal类的作用。</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt;提供精确计算的类&lt;/center&gt;
    
    </summary>
    
    
      <category term="java" scheme="alanngu.github.io/categories/java/"/>
    
    
      <category term="java" scheme="alanngu.github.io/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>Java 8 Functional Interface</title>
    <link href="alanngu.github.io/2019/05/26/javaFunctionInterface/"/>
    <id>alanngu.github.io/2019/05/26/javaFunctionInterface/</id>
    <published>2019-05-26T13:39:38.000Z</published>
    <updated>2020-01-17T07:16:21.339Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><h3 id="什么是函数式接口"><a href="#什么是函数式接口" class="headerlink" title="什么是函数式接口"></a>什么是函数式接口</h3><ul><li>只包含一个抽象方法的接口，称为函数式接口</li><li>可以通过Lambda表达式来创建该接口的对象</li><li>可以在任意函数式接口上使用 @FunctionalInterface 注解，这样做可以检查它是否是一个函数式接口</li></ul><hr><h3 id="自定义函数式接口"><a href="#自定义函数式接口" class="headerlink" title="自定义函数式接口"></a>自定义函数式接口</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">MyNumber</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">getValue</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">myFunc</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getValue</span><span class="params">(T t)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h3 id="作为参数传递Lambda表达式"><a href="#作为参数传递Lambda表达式" class="headerlink" title="作为参数传递Lambda表达式"></a>作为参数传递Lambda表达式</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">toUpperString</span><span class="params">(MyFunc&lt;String&gt; mf, String str)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> mf.getValue(str);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 作为参数传递lambda表达式</span></span><br><span class="line">String newStr = toUpperString((str) -&gt; str.toUpperCase(), <span class="string">"abdcegf"</span>);</span><br><span class="line">System.out.println(newStr);</span><br></pre></td></tr></table></figure><blockquote><p>为了将Lambda表达式作为参数传递，接收 Lambda 表达式的参数类型应该是与该 Lambda 表达式兼容的函数式接口的类型</p></blockquote><hr><h3 id="四大核心函数式接口"><a href="#四大核心函数式接口" class="headerlink" title="四大核心函数式接口"></a>四大核心函数式接口</h3><table><thead><tr><th>函数式接口</th><th>参数类型</th><th>返回类型</th><th>用途</th></tr></thead><tbody><tr><td>Consumer&lt;T&gt;<br>消费型接口</td><td>T</td><td>void</td><td>对类型为T的对象应用操作,<br>包含方法：void accept(T t)</td></tr><tr><td>Supplier&lt;T&gt;<br>供给型接口</td><td></td><td></td><td></td></tr></tbody></table><h3 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h3><ul><li><a href="http://t.cn/A6vi0DP9" target="_blank" rel="noopener">http://t.cn/A6vi0DP9</a></li></ul><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt; Java 函数式接口&lt;/center&gt;
    
    </summary>
    
    
      <category term="Java" scheme="alanngu.github.io/categories/Java/"/>
    
      <category term="Functional Interface" scheme="alanngu.github.io/categories/Java/Functional-Interface/"/>
    
    
      <category term="Java" scheme="alanngu.github.io/tags/Java/"/>
    
      <category term="Functional Interface" scheme="alanngu.github.io/tags/Functional-Interface/"/>
    
  </entry>
  
  <entry>
    <title>Java 8 Lambda</title>
    <link href="alanngu.github.io/2019/05/16/Java-8-Lambda/"/>
    <id>alanngu.github.io/2019/05/16/Java-8-Lambda/</id>
    <published>2019-05-16T12:36:32.000Z</published>
    <updated>2020-01-17T07:16:21.337Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><h3 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h3><p>Lambda表达式在代码中属于一个匿名函数，即没有名称且不受标识符限制的函数。可以理解为是一段可以传递的代码。它是java 8 发布的重要特性，通过使用Lambda表达式可以使代码更加简洁紧凑。</p><h3 id="Basic-syntax-format"><a href="#Basic-syntax-format" class="headerlink" title="Basic syntax format"></a>Basic syntax format</h3><p>Lambda表达式在java语言中引入了新的语法元素和操作符。这个操作符为 <code>-&gt;</code> ，该操作符被称为Lambda操作符或者箭头操作符，它将Lambda分为两个部分：</p><ul><li><strong>左侧</strong> ：指定了Lambda表达式所需要的<code>所有参数</code></li><li><strong>右侧</strong> ：指定了 <code>Lambda体</code>， 即 Lambda 表达式要执行的功能。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 语法格式一 : 无参, 无返回值, Lambda表达式只需要一条语句</span></span><br><span class="line">Runnable r1 = () -&gt; System.out.println(<span class="string">"Hello Lambda!"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 语法格式二 : 一个参数</span></span><br><span class="line">Consumer&lt;String&gt; fun = (args) -&gt; System.out.println(args);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 语法格式三 : lambda只需要一个参数时, 参数的小括号可以省略不写</span></span><br><span class="line">Consumer&lt;String&gt; fun = (args) -&gt; System.out.println(args);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 语法格式四 : lambda需要两个参数且有返回值</span></span><br><span class="line">BinaryOperator&lt;Long&gt; bo = (x, y) - &#123;</span><br><span class="line">    System.out.println(<span class="string">"实现函数接口方法!"</span>);</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 语法格式五 : 当Lambda体只有一条语句时, return与大括号可以省略.</span></span><br><span class="line">BinaryOperator&lt;Long&gt; bo = (x, y) -&gt; x + y;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 语法格式六 : 显式声明lambda需要参数的类型(数据类型可以省略,编译器可自行进行类型推断)</span></span><br><span class="line">BinaryOperator&lt;Long&gt; bo = (Long x, Long y) - &#123;</span><br><span class="line">    System.out.println(<span class="string">"实现函数接口方法!"</span>);</span><br><span class="line">    <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><blockquote><p>类型推断: Lambda 表达式中不需要指定参数类型,程序依然可以编译,这是因为 javac 根据程序的上下文,在后台推断除了参数的类型.Lambda 表达式的类型依赖于上下文环境,是由编译器推断出来的.这就是所谓的<code>类型推断</code></p></blockquote><h3 id="Features-of-Lambda-Expressions"><a href="#Features-of-Lambda-Expressions" class="headerlink" title="Features of Lambda Expressions"></a>Features of Lambda Expressions</h3><ul><li>参数的类型可以显式的声明也可以省略，编译器可以根据上下文自行推断出参数的类型。</li><li>如果有多个参数，须要使用括号括起来，并使用逗号进行分隔。空括号代表参数为空。</li><li>如果lambda表达式只有一行参数,可以不适用括号. 比如 <code>x -&gt; return x *</code></li><li>如果Lambda表达式的主体只有单个语句，且返回值类型与表达式的返回类型相同，则可以省略大括号。如果含有多条语句，则必须使用大括号。</li></ul><h3 id="Lambda-example"><a href="#Lambda-example" class="headerlink" title="Lambda example"></a>Lambda example</h3><ul><li>从匿名内部类到Lambda的转换</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 匿名内部类</span></span><br><span class="line">Runnable runnable = <span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Hello Alan."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// lambda表达式</span></span><br><span class="line">Runnable runnable = () -&gt; System.out.println(<span class="string">"Hello Alan."</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 原本使用匿名内部类作为参数传递</span></span><br><span class="line">TreeSet&lt;String&gt; ts = <span class="keyword">new</span> TreeSet&lt;&gt;(<span class="keyword">new</span> Comparator&lt;String&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compare</span><span class="params">(String o1, String o2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Integer.compare(o1.length(), o2.length());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// lambda表达式作为参数传递</span></span><br><span class="line">TreeSet&lt;String&gt; ts = <span class="keyword">new</span> TreeSet&lt;&gt;((o1,o2) -&gt; Integer.compare(o1.length(),o2.length()));</span><br></pre></td></tr></table></figure><h3 id="Reference-Documents"><a href="#Reference-Documents" class="headerlink" title="Reference Documents"></a>Reference Documents</h3><ul><li><a href="http://t.cn/A6viO4TN" target="_blank" rel="noopener">http://t.cn/A6viO4TN</a></li><li><a href="http://t.cn/A6vi0DP9" target="_blank" rel="noopener">http://t.cn/A6vi0DP9</a></li></ul><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt;java 8 的重要特性-Lambda&lt;/center&gt;
    
    </summary>
    
    
      <category term="Java" scheme="alanngu.github.io/categories/Java/"/>
    
      <category term="Lambda" scheme="alanngu.github.io/categories/Java/Lambda/"/>
    
    
      <category term="Java" scheme="alanngu.github.io/tags/Java/"/>
    
      <category term="Lambda" scheme="alanngu.github.io/tags/Lambda/"/>
    
  </entry>
  
  <entry>
    <title>MySQL查找删除重复数据</title>
    <link href="alanngu.github.io/2019/04/09/searchAndDeleteRepeat/"/>
    <id>alanngu.github.io/2019/04/09/searchAndDeleteRepeat/</id>
    <published>2019-04-09T13:50:12.000Z</published>
    <updated>2020-05-19T09:28:55.447Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><h3 id="如何查找重复行"><a href="#如何查找重复行" class="headerlink" title="如何查找重复行"></a>如何查找重复行</h3><p>第一步的定义什么样的行才是重复行。多数情况下很简单：他们某一列具有相同的值。本文采用这一定义，如果你对重复的定义比这复杂，你需要对sql做些修改。<br>如下为本文用到的数据样本</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student(</span><br><span class="line"><span class="keyword">id</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">not</span> <span class="literal">null</span> auto_increment <span class="keyword">comment</span> <span class="string">'自增主键'</span>,</span><br><span class="line"><span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">collate</span> utf8_bin <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'姓名'</span>,</span><br><span class="line">age <span class="built_in">int</span>(<span class="number">3</span>) <span class="keyword">unsigned</span> <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'年龄'</span>,</span><br><span class="line"><span class="keyword">day</span> <span class="built_in">date</span> <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">comment</span> <span class="string">'日期'</span>,</span><br><span class="line">primary <span class="keyword">key</span> (<span class="keyword">id</span>)</span><br><span class="line">) <span class="keyword">engine</span> = <span class="keyword">InnoDB</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> </span><br><span class="line">    student(<span class="keyword">name</span>,age,<span class="keyword">day</span>)</span><br><span class="line"><span class="keyword">values</span></span><br><span class="line">    (<span class="string">'alan'</span>,<span class="number">18</span>,<span class="string">'2012-10-09'</span>),</span><br><span class="line">    (<span class="string">'peter'</span>,<span class="number">24</span>,<span class="string">'2012-10-09'</span>),</span><br><span class="line">    (<span class="string">'joe'</span>,<span class="number">27</span>,<span class="string">'2012-10-10'</span>);</span><br></pre></td></tr></table></figure><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">id</span>, <span class="keyword">name</span>, age, <span class="keyword">day</span> <span class="keyword">from</span> student；</span><br></pre></td></tr></table></figure><p>执行上方sql查询结果如下表所示</p><table><thead><tr><th>id</th><th>name</th><th>age</th><th>day</th></tr></thead><tbody><tr><td>1</td><td>alan</td><td>18</td><td>2018-10-09</td></tr><tr><td>2</td><td>peter</td><td>24</td><td>2018-10-09</td></tr><tr><td>3</td><td>joe</td><td>27</td><td>2018-10-10</td></tr></tbody></table><p>前⾯两⾏在day字段具有相同的值，因此如何我将他们当做重复⾏，这⾥有⼀查询语句可以查找。查询语句使⽤GROUP BY⼦句 把具有相同字段值的⾏归为⼀组，然后计算组的⼤⼩。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">day</span>,<span class="keyword">count</span>(*) <span class="keyword">as</span> <span class="keyword">count</span> <span class="keyword">from</span> student <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">day</span>;</span><br></pre></td></tr></table></figure><table><thead><tr><th>day</th><th>count</th></tr></thead><tbody><tr><td>2018-10-09</td><td>2</td></tr><tr><td>2018-10-10</td><td>1</td></tr></tbody></table><p>重复⾏的组⼤⼩⼤于1。如何希望只显⽰重复⾏，必须使⽤HAVING⼦句，⽐如</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">day</span>,<span class="keyword">count</span>(*) <span class="keyword">as</span> <span class="keyword">count</span> <span class="keyword">from</span> student <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">day</span> <span class="keyword">having</span> <span class="keyword">count</span> &gt;<span class="number">1</span>;</span><br></pre></td></tr></table></figure><table><thead><tr><th>day</th><th>count</th></tr></thead><tbody><tr><td>2018-10-09</td><td>2</td></tr></tbody></table><p>根据具有相同值的字段分组，然后得知显示大小大于1的组。</p><blockquote><p>为什么不使用where子句？<br>因为where子句过滤的是分组之前的行，having子句过滤的是分组之后的行。</p></blockquote><h3 id="如何删除重复行"><a href="#如何删除重复行" class="headerlink" title="如何删除重复行"></a>如何删除重复行</h3><p>常见的任务是，重复行只保留一行，其它的删除，然后可以创建适当的索引防止以后再有重复的行写入数据库。</p><p>同样，首先应当弄清楚重复行的定义。你要保留的是哪一行呢？第一行，或者是某个字段具有最大值的行？本文中，假设保留的是第一行，id字段具有最小值的行。</p><p>也许最简单的方法是通过临时表。尤其对于MySQL，有些限制是不能在查询语句中select的同时update一个表。简单起见，这里使用临时表的方法。</p><p>我们的任务是删除所有重复行，除了分组中id字段具有最小值的行。因此，需要找出大小大于1分组，以及希望保留的行。可以使用MIN()函数。下面的语句是创建临时表，以及查找需要用delete删除的行。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">temporary</span> <span class="keyword">table</span> to_delete(</span><br><span class="line"><span class="keyword">day</span> <span class="built_in">date</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">min_id <span class="built_in">int</span> <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> to_delete(<span class="keyword">day</span>,min_id)</span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">day</span>,<span class="keyword">MIN</span>(<span class="keyword">id</span>) <span class="keyword">from</span> student <span class="keyword">group</span> <span class="keyword">by</span> <span class="keyword">day</span> <span class="keyword">having</span> <span class="keyword">count</span>(*) &gt;<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> to_delete;</span><br></pre></td></tr></table></figure><table><thead><tr><th>day</th><th>min_id</th></tr></thead><tbody><tr><td>2018-10-09</td><td>1</td></tr></tbody></table><p>有了这些数据，就可以删除重复数据了。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> studentwhere <span class="keyword">exists</span>(</span><br><span class="line">    <span class="keyword">select</span> * <span class="keyword">from</span> to_delete</span><br><span class="line">    <span class="keyword">where</span> to_delete.day = student.day <span class="keyword">and</span> to_delete.min_id &lt;&gt; student.id</span><br><span class="line">);</span><br></pre></td></tr></table></figure><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt;查找数据库中重复的数据&lt;/center&gt;
    
    </summary>
    
    
      <category term="MySQL" scheme="alanngu.github.io/categories/MySQL/"/>
    
    
      <category term="MySQL" scheme="alanngu.github.io/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>查找关闭指定端口号进程</title>
    <link href="alanngu.github.io/2019/04/02/closePort/"/>
    <id>alanngu.github.io/2019/04/02/closePort/</id>
    <published>2019-04-02T14:50:21.000Z</published>
    <updated>2020-05-29T09:31:27.191Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><p>如何关闭运行在某端口的进程,接下来以 :8080端口示例.</p><h3 id="查找占用端口号的进程"><a href="#查找占用端口号的进程" class="headerlink" title="查找占用端口号的进程"></a>查找占用端口号的进程</h3><pre><code>netstat -o -a -n | findstr :8080</code></pre><h3 id="根据PID关闭进程"><a href="#根据PID关闭进程" class="headerlink" title="根据PID关闭进程"></a>根据PID关闭进程</h3><pre><code>taskkill /F /PID 6528</code></pre><p>如下图所示</p><p><img src="closePort1.png" alt=""></p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt;查找并关闭指定端口号正在运行的程序&lt;/center&gt;
    
    </summary>
    
    
      <category term="Tips" scheme="alanngu.github.io/categories/Tips/"/>
    
    
      <category term="Tips" scheme="alanngu.github.io/tags/Tips/"/>
    
  </entry>
  
  <entry>
    <title>Redis Install</title>
    <link href="alanngu.github.io/2019/01/24/redisinstall/"/>
    <id>alanngu.github.io/2019/01/24/redisinstall/</id>
    <published>2019-01-24T12:06:34.000Z</published>
    <updated>2020-05-26T09:56:15.450Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><h3 id="配置环境"><a href="#配置环境" class="headerlink" title="配置环境"></a>配置环境</h3><h4 id="安装gcc"><a href="#安装gcc" class="headerlink" title="安装gcc"></a>安装gcc</h4><p>redis需要使用gcc来编译，如果没有安装gcc当执行make命令时将会报编译错误。</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">yum install cpp</span><br><span class="line">yum install binutils</span><br><span class="line">yum install glibc</span><br><span class="line">yum install glibc-kernheaders</span><br><span class="line">yum install glibc-common</span><br><span class="line">yum install glibc-devel</span><br><span class="line">yum install gcc</span><br><span class="line">yum install make</span><br><span class="line"></span><br><span class="line">yum install tcl</span><br></pre></td></tr></table></figure><p>gcc需要依赖很多东西，有些系统已经预装了，为了保险还是把以上所有的命令都执行一遍。</p><h4 id="升级gcc"><a href="#升级gcc" class="headerlink" title="升级gcc"></a>升级gcc</h4><p>升级gcc到5.3以上的版本，升级到gcc 9版本</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># yum -y install centos-release-scl</span><br><span class="line"># yum -y install devtoolset-<span class="number">9</span>-gcc devtoolset-<span class="number">9</span>-gcc-c++ devtoolset-<span class="number">9</span>-binutils</span><br><span class="line"># scl enable devtoolset-<span class="number">9</span> bash</span><br><span class="line"># gcc -v</span><br><span class="line">Using built-<span class="keyword">in</span> specs.</span><br><span class="line">COLLECT_GCC=gcc</span><br><span class="line">COLLECT_LTO_WRAPPER=/opt/rh/devtoolset-<span class="number">9</span>/root/usr/libexec/gcc/x86_64-redhat-linux/<span class="number">9</span>/lto-wrapper</span><br><span class="line"><span class="function">Target: <span class="title">x86_64</span>-<span class="title">redhat</span>-<span class="title">linux</span></span></span><br><span class="line"><span class="function"><span class="title">Configured</span> <span class="title">with</span>: ../<span class="title">configure</span> --<span class="title">enable</span>-<span class="title">bootstrap</span> --<span class="title">enable</span>-<span class="title">languages</span>=<span class="title">c</span>,<span class="title">c</span>++,<span class="title">fortran</span>,<span class="title">lto</span> --<span class="title">prefix</span>=/<span class="title">opt</span>/<span class="title">rh</span>/<span class="title">devtoolset</span>-9/<span class="title">root</span>/<span class="title">usr</span> --<span class="title">mandir</span>=/<span class="title">opt</span>/<span class="title">rh</span>/<span class="title">devtoolset</span>-9/<span class="title">root</span>/<span class="title">usr</span>/<span class="title">share</span>/<span class="title">man</span> --<span class="title">infodir</span>=/<span class="title">opt</span>/<span class="title">rh</span>/<span class="title">devtoolset</span>-9/<span class="title">root</span>/<span class="title">usr</span>/<span class="title">share</span>/<span class="title">info</span> --<span class="title">with</span>-<span class="title">bugurl</span>=<span class="title">http</span>://<span class="title">bugzilla.redhat.com</span>/<span class="title">bugzilla</span> --<span class="title">enable</span>-<span class="title">shared</span> --<span class="title">enable</span>-<span class="title">threads</span>=<span class="title">posix</span> --<span class="title">enable</span>-<span class="title">checking</span>=<span class="title">release</span> --<span class="title">enable</span>-<span class="title">multilib</span> --<span class="title">with</span>-<span class="title">system</span>-<span class="title">zlib</span> --<span class="title">enable</span>-<span class="title">__cxa_atexit</span> --<span class="title">disable</span>-<span class="title">libunwind</span>-<span class="title">exceptions</span> --<span class="title">enable</span>-<span class="title">gnu</span>-<span class="title">unique</span>-<span class="title">object</span> --<span class="title">enable</span>-<span class="title">linker</span>-<span class="title">build</span>-<span class="title">id</span> --<span class="title">with</span>-<span class="title">gcc</span>-<span class="title">major</span>-<span class="title">version</span>-<span class="title">only</span> --<span class="title">with</span>-<span class="title">linker</span>-<span class="title">hash</span>-<span class="title">style</span>=<span class="title">gnu</span> --<span class="title">with</span>-<span class="title">default</span>-<span class="title">libstdcxx</span>-<span class="title">abi</span>=<span class="title">gcc4</span>-<span class="title">compatible</span> --<span class="title">enable</span>-<span class="title">plugin</span> --<span class="title">enable</span>-<span class="title">initfini</span>-<span class="title">array</span> --<span class="title">with</span>-<span class="title">isl</span>=/<span class="title">builddir</span>/<span class="title">build</span>/<span class="title">BUILD</span>/<span class="title">gcc</span>-9.1.1-20190605/<span class="title">obj</span>-<span class="title">x86_64</span>-<span class="title">redhat</span>-<span class="title">linux</span>/<span class="title">isl</span>-<span class="title">install</span> --<span class="title">disable</span>-<span class="title">libmpx</span> --<span class="title">enable</span>-<span class="title">gnu</span>-<span class="title">indirect</span>-<span class="title">function</span> --<span class="title">with</span>-<span class="title">tune</span>=<span class="title">generic</span> --<span class="title">with</span>-<span class="title">arch_32</span>=<span class="title">x86</span>-64 --<span class="title">build</span>=<span class="title">x86_64</span>-<span class="title">redhat</span>-<span class="title">linux</span></span></span><br><span class="line"><span class="function"><span class="title">Thread</span> <span class="title">model</span>: <span class="title">posix</span></span></span><br><span class="line"><span class="function"><span class="title">gcc</span> <span class="title">version</span> 9.1.1 20190605 (<span class="title">Red</span> <span class="title">Hat</span> 9.1.1-2) (<span class="title">GCC</span>)</span></span><br></pre></td></tr></table></figure><p>如上显示结果表示升级成功。</p><h3 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h3><p>通过redis官网下载最新稳定版本<br><a href="https://redis.io/download" target="_blank" rel="noopener">https://redis.io/download</a></p><p>也可以直接通过命令进行获取下载redis安装包</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># wget http://download.redis.io/releases/redis-<span class="number">6</span>.<span class="number">0</span>.<span class="number">3</span>.tar.gz</span><br><span class="line"># tar xzf redis-<span class="number">6</span>.<span class="number">0</span>.<span class="number">3</span>.tar.gz</span><br><span class="line"># <span class="built_in">cd</span> redis-<span class="number">6</span>.<span class="number">0</span>.<span class="number">3</span></span><br><span class="line"># make</span><br></pre></td></tr></table></figure><h3 id="配置redis"><a href="#配置redis" class="headerlink" title="配置redis"></a>配置redis</h3><ol><li><p>下载好redis安装包，解压安装之后，将配置文件redis.conf复制到etc文件夹下<br><code>cd /usr/local/redis-6.0.3</code><br><code>cp redis.conf /etc</code></p></li><li><p>进入etc，找到redis.conf并修改 daemonize no为 daemonize yes,这样就可以后台运行了。再编辑页面使用/deamonize可以快速查找到需要配置的位置。</p></li><li><p>开启客户端要确保服务端启动<br><code>redis-server /etc/redis.conf</code></p></li><li><p>在redis的src目录下启动客户端<br><code>./redis-cli</code></p></li></ol><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul><li><a href="http://suo.im/6gau48" target="_blank" rel="noopener">http://suo.im/6gau48</a></li><li><a href="http://suo.im/5TCh2T" target="_blank" rel="noopener">http://suo.im/5TCh2T</a></li><li><a href="http://suo.im/5Evcgu" target="_blank" rel="noopener">http://suo.im/5Evcgu</a></li></ul><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt;linux安装redis安装及常见问题&lt;/center&gt;
    
    </summary>
    
    
      <category term="Redis" scheme="alanngu.github.io/categories/Redis/"/>
    
    
      <category term="Redis" scheme="alanngu.github.io/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>Redis Data Type</title>
    <link href="alanngu.github.io/2019/01/18/redisDataType/"/>
    <id>alanngu.github.io/2019/01/18/redisDataType/</id>
    <published>2019-01-18T13:06:34.000Z</published>
    <updated>2020-05-25T09:43:33.910Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><h3 id="String"><a href="#String" class="headerlink" title="String"></a>String</h3><p>String是redis最基本的数据类型，一个key对应一个value。<br>String类型是二进制安全的。也就是说redis的String可以包含任何数据。比如jpg图片或者序列化对象。<br>String类型的值最大可存储512MB。</p><h4 id="Examples"><a href="#Examples" class="headerlink" title="Examples"></a>Examples</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; set test <span class="string">"Hello Redis"</span></span><br><span class="line">OK</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; get test</span><br><span class="line"><span class="string">"Hello Redis"</span></span><br></pre></td></tr></table></figure><p>如上实例中我们使用了Redis的set和get命令。键为test，对应的值为 <strong>Hello Redis</strong><br>注意：一个值最大能存储512MB。</p><h3 id="Hash"><a href="#Hash" class="headerlink" title="Hash"></a>Hash</h3><p>Redis hash是一个键值对集合。<br>Redis hash是一个String类型的field和value的映射表，hash适合用于存储对象。</p><h4 id="Examples-1"><a href="#Examples-1" class="headerlink" title="Examples"></a>Examples</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; hmset student name <span class="string">"alan"</span> age <span class="number">19</span></span><br><span class="line">OK</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; hget student name</span><br><span class="line"><span class="string">"alan"</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; hget student age</span><br><span class="line"><span class="string">"19"</span></span><br></pre></td></tr></table></figure><p>实例中我们使用了Redis hmset，hget命令，hmset设置了两个键值对，hget获取对应field对应的value。<br>每个hash可以存储2^32 - 1个键值对。</p><h3 id="List"><a href="#List" class="headerlink" title="List"></a>List</h3><p>Redis列表是最简单的字符串列表，按照插入顺序排序。可以添加一个元素到列表的头部或尾部。</p><h4 id="lpush-command"><a href="#lpush-command" class="headerlink" title="lpush command"></a>lpush command</h4><p>向list集合中插入元素</p><p><code>lpush key member</code></p><h4 id="lrange-command"><a href="#lrange-command" class="headerlink" title="lrange command"></a>lrange command</h4><p>输出list集合中所有的元素，须执行起始下标和结束下标</p><p><code>lrange key startIndex endIndex</code></p><h4 id="Examples-2"><a href="#Examples-2" class="headerlink" title="Examples"></a>Examples</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; lpush food noodles</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; lpush food hamburger</span><br><span class="line">(integer) <span class="number">2</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; lpush food beef</span><br><span class="line">(integer) <span class="number">3</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; lrange food <span class="number">0</span> <span class="number">5</span></span><br><span class="line"><span class="number">1</span>) <span class="string">"beef"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"hamburger"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"noodles"</span></span><br></pre></td></tr></table></figure><p>列表最多可存储2^32-1个元素。</p><h3 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h3><p>Redis的Set是String类别的无序集合。<br>集合是通过哈希表实现的，所以添加，删除，查找的复杂度都是O(1)。</p><h4 id="sadd-command"><a href="#sadd-command" class="headerlink" title="sadd command"></a>sadd command</h4><p>添加一个String 元素到key对应的set集合中，成功返回1，如果元素已经在集合中返回0。</p><p><code>sadd key member</code></p><h4 id="smembers-command"><a href="#smembers-command" class="headerlink" title="smembers command"></a>smembers command</h4><p>遍历指定set集合中的所有元素</p><p><code>smembers key</code></p><h4 id="Examples-3"><a href="#Examples-3" class="headerlink" title="Examples"></a>Examples</h4><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; sadd food noodles</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; sadd food hamburger</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; sadd food beef</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; sadd food beef</span><br><span class="line">(integer) <span class="number">0</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; smembers food</span><br><span class="line"><span class="number">1</span>) <span class="string">"beef"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"hamburger"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"noodles"</span></span><br></pre></td></tr></table></figure><p>注意：以上实例中beef添加了两次，但根据set集合内元素的不可重复特性，第二次插入的元素将会被忽略。<br>集合中最大成员数为2^32-1。</p><h3 id="zset-sorted-set"><a href="#zset-sorted-set" class="headerlink" title="zset(sorted set)"></a>zset(sorted set)</h3><p>Redis zset和set一样是String类型元素的集合，且不允许重复的元素。<br>zset的每个元素都会关联一个double类型的分数。redis通过分数来对集合中的成员从小到大进行排序。<br>zset的成员是唯一的，但分数(score)可以重复。</p><h4 id="zadd-command"><a href="#zadd-command" class="headerlink" title="zadd command"></a>zadd command</h4><p>添加元素到集合，元素在集合中存在则更新对应的score。</p><p><code>zadd key score member</code></p><h4 id="zrangebyscore-command"><a href="#zrangebyscore-command" class="headerlink" title="zrangebyscore command"></a>zrangebyscore command</h4><p>输出有序set集合中的成员，执行时需要指定输出的起始下标和结束下标</p><p><code>zrangebyscore key startIndex endIndex</code></p><h4 id="Examples-4"><a href="#Examples-4" class="headerlink" title="Examples"></a>Examples</h4><blockquote><p>zset会按照各个元素对应的score进行排序。</p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; zadd people <span class="number">0</span> alan</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; zadd people <span class="number">1</span> peter</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; zadd people <span class="number">2</span> jhon</span><br><span class="line">(integer) <span class="number">1</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; zrangebyscore name <span class="number">0</span> <span class="number">10</span></span><br><span class="line"><span class="number">1</span>) <span class="string">"alan"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"peter"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"jhon"</span></span><br></pre></td></tr></table></figure><blockquote><p>如果将要插入的元素在集合中已存在，set集合不会插入元素，但会更改对应的score。</p></blockquote><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; zadd people <span class="number">5</span> alan</span><br><span class="line">(integer) <span class="number">0</span></span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt; zrangebyscore name <span class="number">0</span> <span class="number">10</span></span><br><span class="line"><span class="number">1</span>) <span class="string">"peter"</span></span><br><span class="line"><span class="number">2</span>) <span class="string">"jhon"</span></span><br><span class="line"><span class="number">3</span>) <span class="string">"alan"</span></span><br></pre></td></tr></table></figure><p>以上实例中，zset中alan的score发生变化导致顺序也发生变化。此时zset中各个元素和对应的score变化如下表。</p><table><thead><tr><th>score</th><th>member</th></tr></thead><tbody><tr><td>0d</td><td>alan</td></tr><tr><td>1d</td><td>peter</td></tr><tr><td>2d</td><td>jhon</td></tr></tbody></table><p>执行完<code>zadd people 5 alan</code>命名后，变化成</p><table><thead><tr><th>score</th><th>member</th></tr></thead><tbody><tr><td>5d</td><td>alan</td></tr><tr><td>1d</td><td>peter</td></tr><tr><td>2d</td><td>jhon</td></tr></tbody></table><p>所以再通过遍历输出zset集合时，alan的顺序变成了最后一个。</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt;redis支持的数据类型&lt;/center&gt;
    
    </summary>
    
    
      <category term="Redis" scheme="alanngu.github.io/categories/Redis/"/>
    
    
      <category term="Redis" scheme="alanngu.github.io/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>Redis Introduction</title>
    <link href="alanngu.github.io/2019/01/13/redisPresentation/"/>
    <id>alanngu.github.io/2019/01/13/redisPresentation/</id>
    <published>2019-01-13T12:06:34.000Z</published>
    <updated>2020-05-25T06:40:17.861Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><h3 id="Redis简介"><a href="#Redis简介" class="headerlink" title="Redis简介"></a>Redis简介</h3><p>Redis是完全开源免费遵守BSD协议的，内存中数据结构存储，可以用作数据库，缓存和消息代理。<br>Redis与其它key-value缓存的特点：</p><ol><li><p>Redis支持数据的持久化，可以将内存中的数据保存到磁盘中，重启时可以再次加载进行使用，与windows的休眠功能类似，将内存中当前运行的程序的数据保存到磁盘里，再次开机时直接进入上次的工作状态。</p></li><li><p>Redis不仅仅支持简单的key-value类型的数据，同时还支持 strings, hashes, lists, sets, sorted sets等数据结构的存储。<br>您可以在这些类型上运行原子操作，例如追加到字符串。在哈希中增加值；将元素推送到列表；计算集的交集，并集和差；或在排序集中获得排名最高的成员。</p></li><li><p>Redis支持数据的备份，即master-slave模式的数据备份。</p></li></ol><h3 id="Redis的优势"><a href="#Redis的优势" class="headerlink" title="Redis的优势"></a>Redis的优势</h3><ol><li>性能高，读的速度是每秒110000次,写的速度是每秒8100次</li><li>丰富的数据类型，redis支持String，list，hash，set等数据类型操作。</li><li>原子性，redis的所有操作都是原子性的，要么全部成功要么全部失败。单个操作是原子性的。多个操作也支持事务，即原子性，通过MULT和EXEC指令包起来。</li><li>丰富的特性 - redis支持publish/subscribe，通知，key过期等特性。</li></ol><h3 id="Redis与其它键值对存储的不同"><a href="#Redis与其它键值对存储的不同" class="headerlink" title="Redis与其它键值对存储的不同"></a>Redis与其它键值对存储的不同</h3><ol><li>Redis有着更为复杂的数据结构并且提供对他们的原子性操作，这是不同于其它数据库的进化路径。Redis的数据类型都是基于基本数据结构的同时对程序员透明，无需进行额外的抽象。</li><li>Redis运行在内存中但是可以持久化到磁盘，所以对不同数据集进行告诉读写时需要权衡内存，因为数据量不能大于硬件内存。在内存数据库方面的另一个优点是，相比在磁盘上相同的复杂的数据结构，在内存中操作起来非常简单，这样redis可以做很多内部复杂性很强的事情。同时，在磁盘格式方面他们是紧凑的已追加的方式产生的，因为他们不需要进行随机访问。</li></ol><h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul><li><a href="http://suo.im/6ulYVG" target="_blank" rel="noopener">http://suo.im/6ulYVG</a></li><li><a href="http://suo.im/5ZB8LH" target="_blank" rel="noopener">http://suo.im/5ZB8LH</a></li></ul><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt;初步认识Redis&lt;/center&gt;
    
    </summary>
    
    
      <category term="Redis" scheme="alanngu.github.io/categories/Redis/"/>
    
    
      <category term="Redis" scheme="alanngu.github.io/tags/Redis/"/>
    
  </entry>
  
  <entry>
    <title>MySQL四种隔离级别的理解</title>
    <link href="alanngu.github.io/2018/11/16/MySQL%E5%9B%9B%E7%A7%8D%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E7%9A%84%E7%90%86%E8%A7%A3/"/>
    <id>alanngu.github.io/2018/11/16/MySQL%E5%9B%9B%E7%A7%8D%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E7%9A%84%E7%90%86%E8%A7%A3/</id>
    <published>2018-11-16T12:32:36.000Z</published>
    <updated>2020-05-22T08:52:21.879Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><h3 id="什么是事务"><a href="#什么是事务" class="headerlink" title="什么是事务"></a>什么是事务</h3><blockquote><p>事务是应用程序一系列严密的操作，所有的操作都必须成功完成，否则在某个操作中所作的所有更改将全部撤销。这也就是事务的原子性，一个事务中一系列的操作的结果只有两种，全部成功或全部失败。<br>事务的结束有两种，当事务中的所有步骤全部成功执行时，事务提交。如果其中一个步骤失败，将发生回滚操作，撤销到没有执行事务时的状态。</p></blockquote><h4 id="事务的ACID"><a href="#事务的ACID" class="headerlink" title="事务的ACID"></a>事务的ACID</h4><p>事务具有四种特性： 原子性（Atomicity）、一致性（Consistency）、隔离性（Isolation）和持续性（Durability）。这四种特性简称为ACID特性。</p><ul><li>原子性。事务时数据库的逻辑工作单位，事务中包含的各种操作要么全部完成，要么全部失败。</li><li>一致性。事务执行的结果必须是使数据库从一个一致性状态百年到另一个一致性状态。因此当数据库只包含成功事务提交的结果时，就说数据库处于一致性状态。如果数据库系统运行中发生故障，有些事务尚未完成就被中断，这些未完成的事务对数据库所作的修改有一部分已写入物理数据库，这是数据库就处于一种不正确的状态，或者说是不一致的状态。</li><li>隔离性。每个事务的执行不会收到其他事务的干扰。即一个事务内部的操作及使用的数据对其它并发事务时隔离的，并发执行的各个事务之间不能相互干扰。</li><li>持续性。也称之为永久性，指一个事务一旦提交，它对数据库中的数据的改变就应该是永久性的。接下来的其他操作或故障不应该对其执行结果有任何影响。</li></ul><h4 id="事务的四种隔离级别"><a href="#事务的四种隔离级别" class="headerlink" title="事务的四种隔离级别"></a>事务的四种隔离级别</h4><table><thead><tr><th align="center">序号</th><th align="center">隔离级别</th></tr></thead><tbody><tr><td align="center">1</td><td align="center">Read Uncommitted</td></tr><tr><td align="center">2</td><td align="center">Read Committed</td></tr><tr><td align="center">3</td><td align="center">Repeatable Read</td></tr><tr><td align="center">4</td><td align="center">Serializable</td></tr></tbody></table><p>SQL标准定义了四类隔离级别，包括了一些具体规则，用来限定事务内外的那些改变时可见的，哪些是不可见的。低级别的隔离级别一般支持更高的并发处理，拥有更低的系统开销。</p><ol><li>Read Uncommitted（读未提交）<br>所有事务都可以看到其它未提交事务的执行结果。因性能优势并不明显，很少用于实际应用。读取未提交的数据，称之为脏读（Dirty Read）。</li></ol><ol start="2"><li>Read Committed（读已提交）<br>大多数数据库系统的默认隔离级别。满足了隔离的简单定义：一个事务只能看见已经提交事务所做的改变。这种隔离级别也支持不可重复读（Nonrepeatable Read），因为统一事务的其它实例在该实例处理期间可能会有新的commit，所以同一select可能返回不同的结果。</li></ol><ol start="3"><li>Repeatable Read（可重读）<br>MySQL的默认事务隔离级别，可以确保同一事务的多个实例在并发读取数据时，会看到同样的数据行。不过理论上，这回导致幻读（Phantom Read）。简单的说，幻读指当用户读取某一范围的数据行时，另一个事务又在该范围内插入了新行，当用户再次读取该范围的数据行时，会发现有新的行。InnoDB和Falcon存储引擎通过多版本并发控制（MVCC，Multiversion Concurrency Controller）机制解决了该问题。</li></ol><ol start="4"><li>Serializable（可串行化）<br>最高的隔离级别，通过强制事务排序，使之不可相互冲突，以解决幻读问题。简而言之，它是在每个读的数据行上加上共享锁。在此级别，可能导致大量的超时现象和锁竞争。</li></ol><p>这四种隔离级别采取不同的锁类型来实现，若读取同一个数据，容易出现问题。举个栗子：</p><blockquote><p>脏读（Dirty Read）：某个事物已更新了一条数据，另一个事务在此时读取了同一条数据，由于某些原因，前一个事务进行了回滚操作，此时后一个事务所读的数据就是错误的。</p><p>不可重复读（Non-repeatable Read）：在一个事务的两次查询之中数据不一致，可能是两次查询过程中插入了一个事务更新了第一次查询的数据。</p><p>幻读（Phant Read）：在一个事务的两次查询中数据行数不一致，例如有一个事务查询了范围内的几列数据，另一个事务在这个范围内插入了新的几列数据，先前的事务在接下来的查询中，就会发现有几列数据是它先前所没有的。</p></blockquote><p>在MySQL中，实现了这四种隔离级别，分别可能产生的问题如下表所示：</p><table><thead><tr><th align="center">隔离级别</th><th align="center">脏读</th><th align="center">不可重复读</th><th align="center">幻读</th></tr></thead><tbody><tr><td align="center">Read Uncommitted</td><td align="center">√</td><td align="center">√</td><td align="center">√</td></tr><tr><td align="center">Read Committed</td><td align="center">×</td><td align="center">√</td><td align="center">√</td></tr><tr><td align="center">Repeatable Read</td><td align="center">×</td><td align="center">×</td><td align="center">√</td></tr><tr><td align="center">Serializable</td><td align="center">×</td><td align="center">×</td><td align="center">×</td></tr></tbody></table><hr><h3 id="测试MySQL的隔离级别"><a href="#测试MySQL的隔离级别" class="headerlink" title="测试MySQL的隔离级别"></a>测试MySQL的隔离级别</h3><p>首先我们先创建test表。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">test</span> (</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">unsigned</span> <span class="keyword">not</span> <span class="literal">null</span> auto_increment <span class="keyword">comment</span> <span class="string">'自增主键'</span>,</span><br><span class="line">    <span class="keyword">num</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">default</span> <span class="string">'0'</span> <span class="keyword">comment</span> <span class="string">'数字'</span>,</span><br><span class="line">    primary <span class="keyword">key</span> (<span class="keyword">id</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span> = <span class="keyword">InnoDB</span> AUTO_INCREMENT = <span class="number">4</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span> = utf8;</span><br></pre></td></tr></table></figure><p>两个命令行客户端分别为A，B；不断改变A的隔离级别，在B端修改数据。</p><h4 id="将A的隔离级别设置为read-uncommitted-未提交读"><a href="#将A的隔离级别设置为read-uncommitted-未提交读" class="headerlink" title="将A的隔离级别设置为read uncommitted(未提交读)"></a>将A的隔离级别设置为read uncommitted(未提交读)</h4><p><img src="read_uncommitted1.png" alt="read_uncommitted1"></p><p>A：启动事务，此时数据为初始状态</p><p><img src="read_uncommitted2.png" alt="read_uncommitted2"></p><p>B: 启动事务，更新数据，但不提交</p><p><img src="read_uncommitted3.png" alt="read_uncommitted3"></p><p>A: 再次读取数据，发现数据已经被修改了，这就是所谓的脏读。</p><p><img src="read_uncommitted4.png" alt="read_uncommitted4"></p><p>B: 回滚事务</p><p><img src="read_uncommitted5.png" alt="read_uncommitted5"></p><p>A: 再次读数据，发现数据变回初始状态</p><p><img src="read_uncommitted6.png" alt="read_uncommitted6"></p><h4 id="将客户端A的事务隔离级别设置为read-committed（读已提交）"><a href="#将客户端A的事务隔离级别设置为read-committed（读已提交）" class="headerlink" title="将客户端A的事务隔离级别设置为read committed（读已提交）"></a>将客户端A的事务隔离级别设置为read committed（读已提交）</h4><p><img src="read_uncommitted1.png" alt="read_committed1"></p><p>A: 启动事务，此时数据为初始状态</p><p><img src="read_uncommitted2.png" alt="read_committed2"></p><p>B: 启动事务，更新数据，但不提交</p><p><img src="read_uncommitted3.png" alt="read_committed3"></p><p>A: 再次读取数据，发现数据未被修改</p><p><img src="read_uncommitted4.png" alt="read_committed4"></p><p>B: 提交事务</p><p><img src="read_uncommitted5.png" alt="read_committed5"></p><p>A: 再次读取数据，发现数据已发生变化，说明B提交的修改被事务A读到了，这就是不可重复读。</p><p><img src="read_uncommitted6.png" alt="read_committed6"></p><p>经过上面的实验可以得出结论，读已提交隔离级别可以解决脏读的问题，但是出现了不可重复读的问题，即事务A再两次查询的数据不一致，因为再两次查询之间事务B更新了一条数据。读已提交只允许读取已提交的记录，但不要求可重复读。</p><h4 id="将A的隔离级别设置未repeatable-read（可重复读）"><a href="#将A的隔离级别设置未repeatable-read（可重复读）" class="headerlink" title="将A的隔离级别设置未repeatable read（可重复读）"></a>将A的隔离级别设置未repeatable read（可重复读）</h4><p><img src="repeatable_read1.png" alt="repeatable_read1.png"></p><p>A: 启动事务，此时数据为初始状态</p><p><img src="repeatable_read2.png" alt="repeatable_read2.png"></p><p>B：启动事务，更新数据，但不提交</p><p><img src="repeatable_read3.png" alt="repeatable_read3.png"></p><p>A: 再次读取数据，发现数据没有被修改</p><p><img src="repeatable_read4.png" alt="repeatable_read4.png"></p><p>B: 提交事务</p><p><img src="repeatable_read5.png" alt="repeatable_read5.png"></p><p>A: 再次读取数据，发现数据仍然没有被更改，这说明可以重复读了</p><p><img src="repeatable_read6.png" alt="repeatable_read6.png"></p><p>B: 插入一条新的数据，并提交</p><p><img src="repeatable_read7.png" alt="repeatable_read7.png"></p><p>A: 再次读取数据，发现数据依然没有发生变化，虽然可以重复读了，但是读取的却不是最新的数据，这就是所谓的幻读。</p><p><img src="repeatable_read8.png" alt="repeatable_read8.png"></p><p>A: 提交本次事务，再次读取数据，发现读取正常了</p><p><img src="repeatable_read9.png" alt="repeatable_read9.png"></p><p>由以上的实验可以得出结论，可重复读隔离级别只允许读取已提交的记录，而且再一个事务两次读取一个记录期间，其它事务B更改该记录。但该事务不要求与其他事务可串行化。例如，当一个事务可以找到由一个已提交事务更新的记录，可能会产生幻读的问题。</p><h4 id="将A的隔离级别设置为可串行化（Serializable）"><a href="#将A的隔离级别设置为可串行化（Serializable）" class="headerlink" title="将A的隔离级别设置为可串行化（Serializable）"></a>将A的隔离级别设置为可串行化（Serializable）</h4><p><img src="serializable1.png" alt="serializable1.png"></p><p>A: 启动事务，此时数据为初始状态</p><p><img src="serializable2.png" alt="serializable2.png"></p><p>B: 开启另一个事务执行插入命令，发现B进入了等待状态，原因是因为A的事务尚未提交，只能等待。此时，B可能会发生等待超时。</p><p><img src="serializable3.png" alt="serializable3.png"></p><p>A: 提交事务</p><p><img src="serializable4.png" alt="serializable4.png"></p><p>B: 发现插入成功</p><p><img src="serializable5.png" alt="serializable5.png"></p><p>serializable完全锁定字段，若一个事务来查询同一份数据就必须等待，知道前一个事务完成并解除锁定为止。是完整的隔离级别，会锁定对应的数据表格，所以效率不高。</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt;真正理解MySQL的四种隔离级别&lt;/center&gt;
    
    </summary>
    
    
      <category term="MySQL" scheme="alanngu.github.io/categories/MySQL/"/>
    
      <category term="Transaction" scheme="alanngu.github.io/categories/MySQL/Transaction/"/>
    
    
      <category term="MySQL" scheme="alanngu.github.io/tags/MySQL/"/>
    
      <category term="Transaction" scheme="alanngu.github.io/tags/Transaction/"/>
    
  </entry>
  
  <entry>
    <title>MySQL Knownledge</title>
    <link href="alanngu.github.io/2018/11/09/MySQL%E7%9F%A5%E8%AF%86/"/>
    <id>alanngu.github.io/2018/11/09/MySQL%E7%9F%A5%E8%AF%86/</id>
    <published>2018-11-09T13:47:36.000Z</published>
    <updated>2020-05-21T14:12:37.308Z</updated>
    
    <content type="html"><![CDATA[<!-- build time:Thu Jan 07 2021 13:57:15 GMT+0800 (GMT+08:00) --><h4 id="示例SQL"><a href="#示例SQL" class="headerlink" title="示例SQL"></a>示例SQL</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">test</span> (</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">unsigned</span> <span class="keyword">not</span> <span class="literal">null</span> auto_increment <span class="keyword">comment</span> <span class="string">'自增主键'</span>,</span><br><span class="line">    <span class="keyword">num</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">not</span> <span class="literal">null</span> <span class="keyword">default</span> <span class="string">'0'</span> <span class="keyword">comment</span> <span class="string">'数字'</span>,</span><br><span class="line">    primary <span class="keyword">key</span> (<span class="keyword">id</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span> = <span class="keyword">InnoDB</span> AUTO_INCREMENT = <span class="number">4</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span> = utf8;</span><br></pre></td></tr></table></figure><p>如上的建表SQL中，出现了ENGINE = InnoDB AUTO_INCREMENT = 4 DEFAULT CHARSET = utf8；但不知道其含义是什么。</p><ol><li><p>InnoDB不就是MySQL的默认引擎吗？<br>此处不写也是可以的，这里写上可以清楚的知道在建表的时候使用了什么引擎。</p></li><li><p>主键已经设置了自增，这里的AUTO_INCREMENT有什么作用？<br>这里设置的数字的意思是想要这条语句在增长的时候，从4开始自增。</p></li><li><p>uft8在这里的作用是什么？<br>代表mysql建立数据库数据表是设定字符集为utf-8.</p></li></ol><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;center&gt;MySQL小知识&lt;/center&gt;
    
    </summary>
    
    
      <category term="MySQL" scheme="alanngu.github.io/categories/MySQL/"/>
    
    
      <category term="MySQL" scheme="alanngu.github.io/tags/MySQL/"/>
    
  </entry>
  
</feed>
